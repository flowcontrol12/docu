<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">DDoS Mitigation | flowcontrol documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://flowcontrol12.github.io/XND module/DDoS Mitigation"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="1.6"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-1.6"><meta data-react-helmet="true" property="og:title" content="DDoS Mitigation | flowcontrol documentation"><meta data-react-helmet="true" name="description" content="The FlowControl system in the XND module supports two features to mitigate DDoS attacks: FlowSpec and RTBH (Remotely Triggered Black Hole). Both require routers that support BGP protocol and optionally FlowSpec feature. When FlowControl detects an attack, it sends a command to the edge router(s) of the organization to block the offending traffic. Depending on the feature used, this command can be a filtering rule to place in an internal FlowSpec table or regular route to inject in the routing table. Both mechanisms work in similar way as depicted on the Fig. 3.1."><meta data-react-helmet="true" property="og:description" content="The FlowControl system in the XND module supports two features to mitigate DDoS attacks: FlowSpec and RTBH (Remotely Triggered Black Hole). Both require routers that support BGP protocol and optionally FlowSpec feature. When FlowControl detects an attack, it sends a command to the edge router(s) of the organization to block the offending traffic. Depending on the feature used, this command can be a filtering rule to place in an internal FlowSpec table or regular route to inject in the routing table. Both mechanisms work in similar way as depicted on the Fig. 3.1."><meta data-react-helmet="true" property="og:image" content="https://flowcontrol12.github.io/img/undraw_online.svg"><meta data-react-helmet="true" name="twitter:image" content="https://flowcontrol12.github.io/img/undraw_online.svg"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://flowcontrol12.github.io/XND module/DDoS Mitigation"><link data-react-helmet="true" rel="alternate" href="https://flowcontrol12.github.io/XND module/DDoS Mitigation" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://flowcontrol12.github.io/XND module/DDoS Mitigation" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d8172548.css">
<link rel="preload" href="/assets/js/runtime~main.89dbf0d1.js" as="script">
<link rel="preload" href="/assets/js/main.e39e4e13.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">flowcontrol documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">1.6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/Coming soon">2.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/XND module/DDoS Mitigation">1.6</a></li></ul></div><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">flowcontrol documentation</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/next/Coming soon">2.0</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/XND module/DDoS Mitigation">1.6</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Installation">Installation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">XN module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Dashboards">Dashboards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/System Status">System Status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Access through REST API">Access through REST API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">XNS module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Security Dashboards">Security Dashboards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Threat Detection">Threat Detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Threat Intelligence Engine">Threat Intelligence Engine</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">XND module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/Performance">Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/FlowControl XND Module">FlowControl XND Module</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/XND module/DDoS Mitigation">DDoS Mitigation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/XND module configuration">XND module configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/DDoS Dashboards">DDoS Dashboards</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/CLI commands">CLI commands</a></li><li class="menu__list-item"><a class="menu__link" href="/Requirements">Requirements</a></li><li class="menu__list-item"><a class="menu__link" href="/Release notes">Release notes</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: 1.6</span><div class="markdown"><header><h1 class="h1Heading_27L5">DDoS Mitigation</h1></header><p>The FlowControl system in the XND module supports two features to mitigate DDoS attacks: FlowSpec and RTBH (Remotely Triggered Black Hole). Both require routers that support BGP protocol and optionally FlowSpec feature. When FlowControl detects an attack, it sends a command to the edge router(s) of the organization to block the offending traffic. Depending on the feature used, this command can be a filtering rule to place in an internal FlowSpec table or regular route to inject in the routing table. Both mechanisms work in similar way as depicted on the <em>Fig. 3.1</em>.</p><p><img alt="image-20201113144640591" src="/assets/images/image-20201113144640591-60cb9e195a92cd18fb9be83155856fcd.png"></p><p><em>Fig. 3.1 DDoS attacks mitigation diagram</em></p><p>​	The FlowControl system establishes BGP sessions with edge routers (green dotted arrows in the figure) that send Flow packets to FlowControl. Additionally, FlowSpec can be configured on routers that support this feature (see the following section for FlowSpec enabled router models). Depending on the feature used, FlowControl sends the following information to routers:</p><ul><li>FlowSpec: attacked server IP address and TCP port. Routers uses this information to filter out unwanted traffic directed to specified IP address and TCP port.</li><li>RTBH: attacked server IP address and a special, non-existent “black hole” IP address, e.g. 192.0.2.1. Routers use both addresses to update their routing tables and to re-direct all the traffic, both legitimate and offending, to the black hole instead to the destination server. Additional static route is required on routers that directs all packets with black-hole destination address (192.0.2.1 in this case) to null or discard interface.</li></ul><p>​	Both FlowSpec and RTBH mitigate attacks, but in latter case the attacked server is completely unavailable, i.e. cannot be reached via SSH or remote desktop. Once the attack stops FlowControl sends commands to routers to remove previously applied FlowSpec filters or RTBH routes and restore normal communication. Only one mitigation mechanism i.e. FlowSpec or RTBH can be used at a time, not both. Additionally, FlowControl sends to the router RTBH next-hop addresses with well-known NO_EXPORT and 666 communities. Detailed information on FlowSpec functionality is available in RFC 5575 &quot;Dissemination of Flow Specification Rules&quot; at <a href="https://tools.ietf.org/html/rfc5575" target="_blank" rel="noopener noreferrer">https://tools.ietf.org/html/rfc5575</a>. For RTBH see RFC “Remote Triggered Black Hole Filtering with Unicast Reverse Path Forwarding (uRPF)”, <a href="https://tools.ietf.org/html/rfc5635" target="_blank" rel="noopener noreferrer">https://tools.ietf.org/html/rfc5635</a>.</p><blockquote><p>The prerequisite for the activation of the above described functionality is the support of FlowSpec protocol by network devices. This information can usually be found in the documentation of the device. The following describes how to configure FlowSpec for Juniper and Cisco devices.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="spec-configuration-on-juniper"></a>Spec configuration on Juniper<a class="hash-link" href="#spec-configuration-on-juniper" title="Direct link to heading">#</a></h3><p>​	The FlowSpec protocol is supported by Juniper MX series routers. Below is example configuration for Juniper devices. The FlowControl system server is assumed to have the following IP address 192.168.0.100 and BGP number AS 65100.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">protocols {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bgp {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    group flowcontrol {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      family inet {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        flow {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          no-validate NO-VALIDATION;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        any;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      neighbor 192.168.0.100 {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description Server FlowControl;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer-as 65100;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">policy-options {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  policy-statement NO-VALIDATION {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    term 1 {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      then accept;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p><strong>Warning !</strong></p><p>The NO-VALIDATION policy causes all IP addresses sent by FlowControl to be placed in the FlowSpec table (inetflow.0), regardless of whether they are in the routing table or not. Its use is not mandatory, but it makes easier to diagnose possible BGP communication problems between FlowControl and the router.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="verifcation-of-bgp-session-between-flowcontrol-and-the-router"></a>Verifcation of BGP session between FlowControl and the router<a class="hash-link" href="#verifcation-of-bgp-session-between-flowcontrol-and-the-router" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@MX&gt; **show bgp summary**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Groups: 1 Peers: 2 Down peers: 0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Peer           AS   InPkt   OutPkt  OutQ  Flaps Last Up/Dwn State|#Active/Received/Accepted/Damped...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100     65100     1     0    0    0      0 Establ**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> inet.0: 0/0/0/0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> inetflow.0: 0/0/0/0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="checking-the-flowspec-table-on-the-router"></a>Checking the FlowSpec table on the router<a class="hash-link" href="#checking-the-flowspec-table-on-the-router" title="Direct link to heading">#</a></h4><p>The following example shows the contents of the FlowSpec table (inetflow.0) after FlowControl has sent to the router a rule to block attack on the destination IP address 192.160.20.1 and destination TCP port 53:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@MX&gt; **show route table inetflow.0 detail**   </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">inetflow.0: 1 destinations, 1 routes (1 active, 0 holddown, 0 hidden)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.20.1,\*,dstport=53**/term:1 (1 entry, 1 announced)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *BGP  Preference: 170/-101</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Communities: **traffic-rate:0:0**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="flowspec-configuration-on-cisco-asr-9000-devices"></a>FlowSpec configuration on Cisco ASR 9000 devices<a class="hash-link" href="#flowspec-configuration-on-cisco-asr-9000-devices" title="Direct link to heading">#</a></h3><p>Below is a sample configuration of the ASR 9000. It is assumed that the FlowControl system has the following IP address: 192.168.0.100 and  BGP AS 65100.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly router"><pre tabindex="0" class="prism-code language-router codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bgp router-id 192.168.0.50</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 unicast</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">neighbor 192.168.0.100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> remote-as 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 flowSpec</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  route-policy FlowControl in</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  validation disable</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">route-policy FlowControl</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> done</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end-policy</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">flowspec</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> local-install interface-all</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>Notes:</p><ol><li>The IOS-XR system requires the definition of filtering policies for routes (IP prefixes) sent and received by the BGP process. In this case, FlowControl policy has been defined which accepts all routes (done command). It is applied in the incoming direction (route-policy FlowControl in command) in the address-family ipv4 flowspec section, which means that the router accepts all FlowSpec rules sent by FlowControl.</li><li>The validation disable command causes the router to accept all IP addresses sent by FlowControl, regardless of whether they are in the routing table or not. The use of this command is not mandatory, but it is recommended because it makes easier to diagnose possible BGP communication problems between FlowControl and the router.</li><li>The flowspec local-install interface-all command enables FlowSpec protocol support on all interfaces.</li></ol></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="verification-of-the-bgp-session-between-flowcontrol-and-the-router"></a>Verification of the BGP session between FlowControl and the router<a class="hash-link" href="#verification-of-the-bgp-session-between-flowcontrol-and-the-router" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#**show bgp neighbor brief**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed Jul 22 09:35:06.619 UTC</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Neighbor    Spk  AS Description             Up/Down NBRState</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100   0 65100                   00:03:32 Established**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="checking-the-flowspec-table-on-the-router-1"></a>Checking the FlowSpec table on the router<a class="hash-link" href="#checking-the-flowspec-table-on-the-router-1" title="Direct link to heading">#</a></h4><p>The following example shows the contents of the FlowSpec table after FlowControl has sent to the router a rule to block attack on the destination IP address 192.160.20.1 and destination TCP port 53:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#**show flowSpec afi-all**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed Jul 22 09:38:20.791 UTC</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">AFI: IPv4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> **Flow      :Dest:192.168.20.1/32,DPort:=53/2**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Actions   :**Traffic-rate: 0 bps** (bgp.1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="flowspec-configuration-on-cisco-csr-1000v"></a>FlowSpec configuration on Cisco CSR 1000v<a class="hash-link" href="#flowspec-configuration-on-cisco-csr-1000v" title="Direct link to heading">#</a></h3><p>Below is a sample configuration of the CSR 1000. It is assumed that the FlowControl system has the following IP address: 192.168.0.100 and BGP AS 65100.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router bgp 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bgp router-id 192.168.0.50</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bgp log-neighbor-changes</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 remote-as 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 flowspec</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 activate</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 validation off</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> exit-address-family</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">flowspec</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> local-install interface-all</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>Notes:</p><ol><li>The “neighbor x.x.x.x validation off” command instructs the router to accept all IP addresses sent by FlowControl, regardless of whether they are in the routing table or not.</li><li>The flowspec local-install interface-all command enables FlowSpec protocol support on all interfaces.</li></ol></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="verification-of-the-bgp-session-between-flowcontrol-and-the-router-1"></a>Verification of the BGP session between FlowControl and the router<a class="hash-link" href="#verification-of-the-bgp-session-between-flowcontrol-and-the-router-1" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSR1000V#**show ip bgp summary** </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP router identifier 192.168.0.50, local AS number 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP table version is 1, main routing table version 1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Neighbor    V      AS MsgRcvd MsgSent  TblVer InQ OutQ Up/Down State/PfxRcd</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100  4    65100    5    8    1   0  0 00:03:21    0**</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="checking-the-flowspec-table-on-the-router-2"></a>Checking the FlowSpec table on the router<a class="hash-link" href="#checking-the-flowspec-table-on-the-router-2" title="Direct link to heading">#</a></h4><p>The following example shows the contents of the FlowSpec table after FlowControl has sent to the router a rule to block attack on the destination IP address 192.160.20.1 and destination TCP port 53:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSR1000V #**show bgp ipv4 flowspec detail** </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP routing table entry for **Dest:192.168.20.1/32,DPort:=53/2,** version 2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Paths: (1 available, best #1, table IPv4-Flowspec-BGP-Table)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Not advertised to any peer</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Refresh Epoch 1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.0.0.0 from 192.168.0.100 (192.168.0.100)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Origin incomplete, localpref 100, valid, external, best</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Extended Community: **FLOWSPEC Traffic-rate:0,0**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   rx pathid: 0, tx pathid: 0x0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="rtbh-configuration-on-juniper"></a>RTBH configuration on Juniper<a class="hash-link" href="#rtbh-configuration-on-juniper" title="Direct link to heading">#</a></h3><p>Below is a sample configuration for Juniper devices. The FlowControl system server is assumed to have the following IP address 192.168.0.100 and BGP number AS 65100. Additionally the black-hole address is 192.0.2.1.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">protocols {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bgp {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    group flowcontrol {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    …</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      neighbor 192.168.0.100 {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description Serwer FlowControl;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        family inet {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          unicast;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer-as 65100;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-options {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  static {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    route 192.0.2.1/32 discard;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="verifcation-of-bgp-session-between-flowcontrol-and-the-router-1"></a>Verifcation of BGP session between FlowControl and the router<a class="hash-link" href="#verifcation-of-bgp-session-between-flowcontrol-and-the-router-1" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@MX&gt; **show bgp summary**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Groups: 1 Peers: 2 Down peers: 0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Peer           AS   InPkt   OutPkt  OutQ  Flaps Last Up/Dwn State|#Active/Received/Accepted/Damped...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100     65100     1     0    0    0      0 Establ**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> inet.0: 0/0/0/0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> inetflow.0: 0/0/0/0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="checking-the-routing-table-on-the-router"></a>Checking the routing table on the router<a class="hash-link" href="#checking-the-routing-table-on-the-router" title="Direct link to heading">#</a></h4><p>The following example shows the contents of the routing table (inet.0) after FlowControl has sent to the router the black-hole IP address 192.0.2.1 as the next-hop for attacked IP address 192.168.20.1:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@vCP1&gt; **show route table inet.0**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">inet.0: 5 destinations, 5 routes (5 active, 0 holddown, 0 hidden)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\+ = Active Route, - = Last Active, * = Both</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 192.0.2.1/32    *[Static/5] 00:12:05</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           Discard</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">192.168.20.1/32  *[BGP/170] 00:00:35, localpref 100, from 192.168.0.100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          AS path: 65100 ?, validation-state: unverified</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           to Discard</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="rtbh-configuration-on-cisco-asr-9000"></a>RTBH configuration on Cisco ASR 9000<a class="hash-link" href="#rtbh-configuration-on-cisco-asr-9000" title="Direct link to heading">#</a></h3><p>Below is a sample configuration for Cisco ASR 9000 devices. The FlowControl system server is assumed to have the following IP address 192.168.0.100 and BGP number AS 65100. Additionally the black-hole address is 192.0.2.1</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router static</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 unicast</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 192.0.2.1/32 Null0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">route-policy RTBH</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> if source in (192.168.0.100/32) then</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> endif</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end-policy</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router bgp 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> remote-as 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 unicast</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  route-policy RTBH in</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>Notes:</p><ol><li>The IOS-XR system requires the definition of filtering policies for routes (IP prefixes) sent and received by the BGP process. In this case, RTBH policy has been defined which accepts all routes (done command). It is applied in the incoming direction (route-policy RTBH in command) in the address-family ipv4 unicast section, which means that the router accepts all routes sent by FlowControl.</li><li>Both FlowControl and the router must be in the same AS. The RTBH feature does not work if both devices are in different AS and establish eBGP connection.</li></ol></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="verification-of-the-bgp-session-between-flowcontrol-and-the-router-2"></a>Verification of the BGP session between FlowControl and the router<a class="hash-link" href="#verification-of-the-bgp-session-between-flowcontrol-and-the-router-2" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> RP/0/RP0/CPU0:ASR9000#**show bgp neighbor brief**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed Jul 22 09:35:06.619 UTC</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Neighbor    Spk  AS Description             Up/Down NBRState</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100   0 65100                   00:03:32 Established**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="checking-the-routing-table-on-the-router-1"></a>Checking the routing table on the router<a class="hash-link" href="#checking-the-routing-table-on-the-router-1" title="Direct link to heading">#</a></h4><p>The following example shows contents of the routing table after FlowControl has sent to the router the black-hole IP address 192.0.2.1 as the next-hop for attacked IP address 192.168.20.1. The routing table consists of two entries: static one that directs to Null0 interface traffic destined to 192.0.2.1 address, and the dynamic BGP entry that sets next-hop for the attacked IP 192.168.20.1 to the above IP address 192.0.2.1. Effectively all the traffic destined to IP 192.168.20.1 is directed to the Null0 interface, i.e. is dropped.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#**show ip route**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**S  192.0.2.1/32 is directly connected, 01:50:10, Null0**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**B  192.168.20.1/32 [20/0] via 192.0.2.1, 00:55:23**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="rtbh-configuration-on-cisco-csr-1000v"></a>RTBH configuration on Cisco CSR 1000v<a class="hash-link" href="#rtbh-configuration-on-cisco-csr-1000v" title="Direct link to heading">#</a></h3><p>Below is a sample configuration for Cisco CSR 1000v devices. The FlowControl system server is assumed to have the following IP address 192.168.0.100 and BGP number AS 65100. Additionally the black-hole address is 192.0.2.1</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router bgp 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bgp router-id 192.168.0.50</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 remote-as 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 activate</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> exit-address-family</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip route 192.0.2.1 255.255.255.255 Null0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>Notes:</p><p>Both Flowcontrol and the router must be in the same AS. The RTBH feature does not work if both devices are in different AS and establish eBGP connection.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="verification-of-the-bgp-session-between-flowcontrol-and-the-router-3"></a>Verification of the BGP session between FlowControl and the router<a class="hash-link" href="#verification-of-the-bgp-session-between-flowcontrol-and-the-router-3" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSR1000V#**show ip bgp summary** </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP router identifier 192.168.0.50, local AS number 65100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP table version is 1, main routing table version 1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Neighbor    V      AS MsgRcvd MsgSent  TblVer InQ OutQ Up/Down State/PfxRcd</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100  4    65100    5    8    1  0  0 00:03:21    0**</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="checking-the-routing-table-on-the-router-2"></a>Checking the routing table on the router<a class="hash-link" href="#checking-the-routing-table-on-the-router-2" title="Direct link to heading">#</a></h4><p>The following example shows contents of the routing table after FlowControl has sent to the router the black-hole IP address 192.0.2.1 as the next-hop for attacked IP address 192.168.20.1. The routing table consists of two entries: static one that directs to Null0 interface traffic destined to 192.0.2.1 address, and the dynamic BGP entry that sets next-hop for the attacked IP 192.168.20.1 to the above IP address 192.0.2.1. Effectively all the traffic destined to IP 192.168.20.1 is directed to the Null0 interface, i.e. is dropped.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSR1000V#**show ip route**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   192.0.2.0/32 is subnetted, 1 subnets</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**S    192.0.2.1 is directly connected, Null0**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   192.168.20.0/32 is subnetted, 1 subnets</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**B    192.168.20.1 [200/0] via 192.0.2.1, 00:00:06**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2021-12-17T13:05:15.000Z">12/17/2021</time></b> by <b>Jan Horubała</b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/XND module/FlowControl XND Module"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« FlowControl XND Module</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/XND module/XND module configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">XND module configuration »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#spec-configuration-on-juniper" class="table-of-contents__link">Spec configuration on Juniper</a></li><li><a href="#flowspec-configuration-on-cisco-asr-9000-devices" class="table-of-contents__link">FlowSpec configuration on Cisco ASR 9000 devices</a></li><li><a href="#flowspec-configuration-on-cisco-csr-1000v" class="table-of-contents__link">FlowSpec configuration on Cisco CSR 1000v</a></li><li><a href="#rtbh-configuration-on-juniper" class="table-of-contents__link">RTBH configuration on Juniper</a></li><li><a href="#rtbh-configuration-on-cisco-asr-9000" class="table-of-contents__link">RTBH configuration on Cisco ASR 9000</a></li><li><a href="#rtbh-configuration-on-cisco-csr-1000v" class="table-of-contents__link">RTBH configuration on Cisco CSR 1000v</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Sycope</div></div></div></footer></div>
<script src="/assets/js/runtime~main.89dbf0d1.js"></script>
<script src="/assets/js/main.e39e4e13.js"></script>
</body>
</html>