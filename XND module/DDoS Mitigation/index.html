<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-1.6 plugin-docs plugin-id-default docs-doc-id-XND module/DDoS Mitigation">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="search" type="application/opensearchdescription+xml" title="Sycope Documentation" href="/opensearch.xml">

<script src="https://buttons.github.io/buttons.js"></script><title data-rh="true">DDoS Mitigation | Sycope Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://documentation.sycope.com/XND module/DDoS Mitigation"><meta data-rh="true" name="docusaurus_locale" content="en-GB"><meta data-rh="true" name="docsearch:language" content="en-GB"><meta data-rh="true" name="docusaurus_version" content="1.6"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.6"><meta data-rh="true" name="docsearch:version" content="1.6"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.6"><meta data-rh="true" property="og:title" content="DDoS Mitigation | Sycope Documentation"><meta data-rh="true" name="description" content="The FlowControl system in the XND module supports two features to mitigate DDoS attacks: FlowSpec and RTBH (Remotely Triggered Black Hole). Both require routers that support BGP protocol and optionally FlowSpec feature. When FlowControl detects an attack, it sends a command to the edge router(s) of the organization to block the offending traffic. Depending on the feature used, this command can be a filtering rule to place in an internal FlowSpec table or regular route to inject in the routing table. Both mechanisms work in similar way as depicted on the Fig. 3.1."><meta data-rh="true" property="og:description" content="The FlowControl system in the XND module supports two features to mitigate DDoS attacks: FlowSpec and RTBH (Remotely Triggered Black Hole). Both require routers that support BGP protocol and optionally FlowSpec feature. When FlowControl detects an attack, it sends a command to the edge router(s) of the organization to block the offending traffic. Depending on the feature used, this command can be a filtering rule to place in an internal FlowSpec table or regular route to inject in the routing table. Both mechanisms work in similar way as depicted on the Fig. 3.1."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://documentation.sycope.com/XND module/DDoS Mitigation"><link data-rh="true" rel="alternate" href="https://documentation.sycope.com/XND module/DDoS Mitigation" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://documentation.sycope.com/XND module/DDoS Mitigation" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://VTLMOZMQ8V-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ce192c60.css">
<link rel="preload" href="/assets/js/runtime~main.8e163d66.js" as="script">
<link rel="preload" href="/assets/js/main.0fa93cde.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-sycope.svg" alt="sycope documentation" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-sycope.svg" alt="sycope documentation" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">sycope documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item"><p style="margin: 0 -12px; color: white">version:</p></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/">1.6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/">2.0 🚧</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/XND module/DDoS Mitigation">1.6</a></li></ul></div><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/">XN module</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/XNS module/Introduction">XNS module</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/XND module/Performance">XND module</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/Performance">Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/FlowControl XND Module">FlowControl XND Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/XND module/DDoS Mitigation">DDoS Mitigation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/XND module configuration">XND module configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/DDoS Dashboards">DDoS Dashboards</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/CLI commands">CLI commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Requirements">Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Release notes">Release notes</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">XND module</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">DDoS Mitigation</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.6</span><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DDoS Mitigation</h1></header><p>The FlowControl system in the XND module supports two features to mitigate DDoS attacks: FlowSpec and RTBH (Remotely Triggered Black Hole). Both require routers that support BGP protocol and optionally FlowSpec feature. When FlowControl detects an attack, it sends a command to the edge router(s) of the organization to block the offending traffic. Depending on the feature used, this command can be a filtering rule to place in an internal FlowSpec table or regular route to inject in the routing table. Both mechanisms work in similar way as depicted on the <em>Fig. 3.1</em>.</p><p><img loading="lazy" alt="image-20201113144640591" src="/assets/images/image-20201113144640591-60cb9e195a92cd18fb9be83155856fcd.png" width="645" height="546" class="img_E7b_"></p><p><em>Fig. 3.1 DDoS attacks mitigation diagram</em></p><p>​	The FlowControl system establishes BGP sessions with edge routers (green dotted arrows in the figure) that send Flow packets to FlowControl. Additionally, FlowSpec can be configured on routers that support this feature (see the following section for FlowSpec enabled router models). Depending on the feature used, FlowControl sends the following information to routers:</p><ul><li>FlowSpec: attacked server IP address and TCP port. Routers uses this information to filter out unwanted traffic directed to specified IP address and TCP port.</li><li>RTBH: attacked server IP address and a special, non-existent “black hole” IP address, e.g. 192.0.2.1. Routers use both addresses to update their routing tables and to re-direct all the traffic, both legitimate and offending, to the black hole instead to the destination server. Additional static route is required on routers that directs all packets with black-hole destination address (192.0.2.1 in this case) to null or discard interface.</li></ul><p>​	Both FlowSpec and RTBH mitigate attacks, but in latter case the attacked server is completely unavailable, i.e. cannot be reached via SSH or remote desktop. Once the attack stops FlowControl sends commands to routers to remove previously applied FlowSpec filters or RTBH routes and restore normal communication. Only one mitigation mechanism i.e. FlowSpec or RTBH can be used at a time, not both. Additionally, FlowControl sends to the router RTBH next-hop addresses with well-known NO_EXPORT and 666 communities. Detailed information on FlowSpec functionality is available in RFC 5575 &quot;Dissemination of Flow Specification Rules&quot; at <a href="https://tools.ietf.org/html/rfc5575" target="_blank" rel="noopener noreferrer">https://tools.ietf.org/html/rfc5575</a>. For RTBH see RFC “Remote Triggered Black Hole Filtering with Unicast Reverse Path Forwarding (uRPF)”, <a href="https://tools.ietf.org/html/rfc5635" target="_blank" rel="noopener noreferrer">https://tools.ietf.org/html/rfc5635</a>.</p><blockquote><p>The prerequisite for the activation of the above described functionality is the support of FlowSpec protocol by network devices. This information can usually be found in the documentation of the device. The following describes how to configure FlowSpec for Juniper and Cisco devices.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="spec-configuration-on-juniper">Spec configuration on Juniper<a class="hash-link" href="#spec-configuration-on-juniper" title="Direct link to heading">​</a></h3><p>​	The FlowSpec protocol is supported by Juniper MX series routers. Below is example configuration for Juniper devices. The FlowControl system server is assumed to have the following IP address 192.168.0.100 and BGP number AS 65100.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">protocols {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bgp {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    group flowcontrol {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      family inet {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        flow {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          no-validate NO-VALIDATION;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        any;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      neighbor 192.168.0.100 {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description Server FlowControl;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer-as 65100;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">policy-options {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  policy-statement NO-VALIDATION {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    term 1 {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      then accept;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>Warning !</strong></p><p>The NO-VALIDATION policy causes all IP addresses sent by FlowControl to be placed in the FlowSpec table (inetflow.0), regardless of whether they are in the routing table or not. Its use is not mandatory, but it makes easier to diagnose possible BGP communication problems between FlowControl and the router.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="verifcation-of-bgp-session-between-flowcontrol-and-the-router">Verifcation of BGP session between FlowControl and the router<a class="hash-link" href="#verifcation-of-bgp-session-between-flowcontrol-and-the-router" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@MX&gt; **show bgp summary**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Groups: 1 Peers: 2 Down peers: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Peer           AS   InPkt   OutPkt  OutQ  Flaps Last Up/Dwn State|#Active/Received/Accepted/Damped...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100     65100     1     0    0    0      0 Establ**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> inet.0: 0/0/0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> inetflow.0: 0/0/0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="checking-the-flowspec-table-on-the-router">Checking the FlowSpec table on the router<a class="hash-link" href="#checking-the-flowspec-table-on-the-router" title="Direct link to heading">​</a></h4><p>The following example shows the contents of the FlowSpec table (inetflow.0) after FlowControl has sent to the router a rule to block attack on the destination IP address 192.160.20.1 and destination TCP port 53:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@MX&gt; **show route table inetflow.0 detail**   </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">inetflow.0: 1 destinations, 1 routes (1 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.20.1,\*,dstport=53**/term:1 (1 entry, 1 announced)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *BGP  Preference: 170/-101</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Communities: **traffic-rate:0:0**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="flowspec-configuration-on-cisco-asr-9000-devices">FlowSpec configuration on Cisco ASR 9000 devices<a class="hash-link" href="#flowspec-configuration-on-cisco-asr-9000-devices" title="Direct link to heading">​</a></h3><p>Below is a sample configuration of the ASR 9000. It is assumed that the FlowControl system has the following IP address: 192.168.0.100 and  BGP AS 65100.</p><div class="language-router codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-router codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bgp router-id 192.168.0.50</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">neighbor 192.168.0.100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> remote-as 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 flowSpec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  route-policy FlowControl in</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  validation disable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">route-policy FlowControl</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> done</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end-policy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">flowspec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> local-install interface-all</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Notes:</p><ol><li>The IOS-XR system requires the definition of filtering policies for routes (IP prefixes) sent and received by the BGP process. In this case, FlowControl policy has been defined which accepts all routes (done command). It is applied in the incoming direction (route-policy FlowControl in command) in the address-family ipv4 flowspec section, which means that the router accepts all FlowSpec rules sent by FlowControl.</li><li>The validation disable command causes the router to accept all IP addresses sent by FlowControl, regardless of whether they are in the routing table or not. The use of this command is not mandatory, but it is recommended because it makes easier to diagnose possible BGP communication problems between FlowControl and the router.</li><li>The flowspec local-install interface-all command enables FlowSpec protocol support on all interfaces.</li></ol></blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="verification-of-the-bgp-session-between-flowcontrol-and-the-router">Verification of the BGP session between FlowControl and the router<a class="hash-link" href="#verification-of-the-bgp-session-between-flowcontrol-and-the-router" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#**show bgp neighbor brief**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed Jul 22 09:35:06.619 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Neighbor    Spk  AS Description             Up/Down NBRState</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100   0 65100                   00:03:32 Established**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="checking-the-flowspec-table-on-the-router-1">Checking the FlowSpec table on the router<a class="hash-link" href="#checking-the-flowspec-table-on-the-router-1" title="Direct link to heading">​</a></h4><p>The following example shows the contents of the FlowSpec table after FlowControl has sent to the router a rule to block attack on the destination IP address 192.160.20.1 and destination TCP port 53:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#**show flowSpec afi-all**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed Jul 22 09:38:20.791 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">AFI: IPv4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> **Flow      :Dest:192.168.20.1/32,DPort:=53/2**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Actions   :**Traffic-rate: 0 bps** (bgp.1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="flowspec-configuration-on-cisco-csr-1000v">FlowSpec configuration on Cisco CSR 1000v<a class="hash-link" href="#flowspec-configuration-on-cisco-csr-1000v" title="Direct link to heading">​</a></h3><p>Below is a sample configuration of the CSR 1000. It is assumed that the FlowControl system has the following IP address: 192.168.0.100 and BGP AS 65100.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router bgp 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bgp router-id 192.168.0.50</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bgp log-neighbor-changes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 remote-as 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 flowspec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 activate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 validation off</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> exit-address-family</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">flowspec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> local-install interface-all</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Notes:</p><ol><li>The “neighbor x.x.x.x validation off” command instructs the router to accept all IP addresses sent by FlowControl, regardless of whether they are in the routing table or not.</li><li>The flowspec local-install interface-all command enables FlowSpec protocol support on all interfaces.</li></ol></blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="verification-of-the-bgp-session-between-flowcontrol-and-the-router-1">Verification of the BGP session between FlowControl and the router<a class="hash-link" href="#verification-of-the-bgp-session-between-flowcontrol-and-the-router-1" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSR1000V#**show ip bgp summary** </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP router identifier 192.168.0.50, local AS number 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP table version is 1, main routing table version 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Neighbor    V      AS MsgRcvd MsgSent  TblVer InQ OutQ Up/Down State/PfxRcd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100  4    65100    5    8    1   0  0 00:03:21    0**</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="checking-the-flowspec-table-on-the-router-2">Checking the FlowSpec table on the router<a class="hash-link" href="#checking-the-flowspec-table-on-the-router-2" title="Direct link to heading">​</a></h4><p>The following example shows the contents of the FlowSpec table after FlowControl has sent to the router a rule to block attack on the destination IP address 192.160.20.1 and destination TCP port 53:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSR1000V #**show bgp ipv4 flowspec detail** </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP routing table entry for **Dest:192.168.20.1/32,DPort:=53/2,** version 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Paths: (1 available, best #1, table IPv4-Flowspec-BGP-Table)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Not advertised to any peer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Refresh Epoch 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.0.0.0 from 192.168.0.100 (192.168.0.100)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Origin incomplete, localpref 100, valid, external, best</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Extended Community: **FLOWSPEC Traffic-rate:0,0**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   rx pathid: 0, tx pathid: 0x0</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="rtbh-configuration-on-juniper">RTBH configuration on Juniper<a class="hash-link" href="#rtbh-configuration-on-juniper" title="Direct link to heading">​</a></h3><p>Below is a sample configuration for Juniper devices. The FlowControl system server is assumed to have the following IP address 192.168.0.100 and BGP number AS 65100. Additionally the black-hole address is 192.0.2.1.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">protocols {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bgp {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    group flowcontrol {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    …</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      neighbor 192.168.0.100 {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description Serwer FlowControl;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        family inet {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          unicast;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer-as 65100;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-options {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  static {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    route 192.0.2.1/32 discard;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="verifcation-of-bgp-session-between-flowcontrol-and-the-router-1">Verifcation of BGP session between FlowControl and the router<a class="hash-link" href="#verifcation-of-bgp-session-between-flowcontrol-and-the-router-1" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@MX&gt; **show bgp summary**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Groups: 1 Peers: 2 Down peers: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Peer           AS   InPkt   OutPkt  OutQ  Flaps Last Up/Dwn State|#Active/Received/Accepted/Damped...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100     65100     1     0    0    0      0 Establ**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> inet.0: 0/0/0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> inetflow.0: 0/0/0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="checking-the-routing-table-on-the-router">Checking the routing table on the router<a class="hash-link" href="#checking-the-routing-table-on-the-router" title="Direct link to heading">​</a></h4><p>The following example shows the contents of the routing table (inet.0) after FlowControl has sent to the router the black-hole IP address 192.0.2.1 as the next-hop for attacked IP address 192.168.20.1:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@vCP1&gt; **show route table inet.0**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">inet.0: 5 destinations, 5 routes (5 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\+ = Active Route, - = Last Active, * = Both</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 192.0.2.1/32    *[Static/5] 00:12:05</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           Discard</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">192.168.20.1/32  *[BGP/170] 00:00:35, localpref 100, from 192.168.0.100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          AS path: 65100 ?, validation-state: unverified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           to Discard</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="rtbh-configuration-on-cisco-asr-9000">RTBH configuration on Cisco ASR 9000<a class="hash-link" href="#rtbh-configuration-on-cisco-asr-9000" title="Direct link to heading">​</a></h3><p>Below is a sample configuration for Cisco ASR 9000 devices. The FlowControl system server is assumed to have the following IP address 192.168.0.100 and BGP number AS 65100. Additionally the black-hole address is 192.0.2.1</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router static</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 192.0.2.1/32 Null0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">route-policy RTBH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> if source in (192.168.0.100/32) then</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> endif</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end-policy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router bgp 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> remote-as 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4 unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  route-policy RTBH in</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">!</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Notes:</p><ol><li>The IOS-XR system requires the definition of filtering policies for routes (IP prefixes) sent and received by the BGP process. In this case, RTBH policy has been defined which accepts all routes (done command). It is applied in the incoming direction (route-policy RTBH in command) in the address-family ipv4 unicast section, which means that the router accepts all routes sent by FlowControl.</li><li>Both FlowControl and the router must be in the same AS. The RTBH feature does not work if both devices are in different AS and establish eBGP connection.</li></ol></blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="verification-of-the-bgp-session-between-flowcontrol-and-the-router-2">Verification of the BGP session between FlowControl and the router<a class="hash-link" href="#verification-of-the-bgp-session-between-flowcontrol-and-the-router-2" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> RP/0/RP0/CPU0:ASR9000#**show bgp neighbor brief**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed Jul 22 09:35:06.619 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Neighbor    Spk  AS Description             Up/Down NBRState</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100   0 65100                   00:03:32 Established**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="checking-the-routing-table-on-the-router-1">Checking the routing table on the router<a class="hash-link" href="#checking-the-routing-table-on-the-router-1" title="Direct link to heading">​</a></h4><p>The following example shows contents of the routing table after FlowControl has sent to the router the black-hole IP address 192.0.2.1 as the next-hop for attacked IP address 192.168.20.1. The routing table consists of two entries: static one that directs to Null0 interface traffic destined to 192.0.2.1 address, and the dynamic BGP entry that sets next-hop for the attacked IP 192.168.20.1 to the above IP address 192.0.2.1. Effectively all the traffic destined to IP 192.168.20.1 is directed to the Null0 interface, i.e. is dropped.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RP/0/RP0/CPU0:ASR9000#**show ip route**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**S  192.0.2.1/32 is directly connected, 01:50:10, Null0**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**B  192.168.20.1/32 [20/0] via 192.0.2.1, 00:55:23**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="rtbh-configuration-on-cisco-csr-1000v">RTBH configuration on Cisco CSR 1000v<a class="hash-link" href="#rtbh-configuration-on-cisco-csr-1000v" title="Direct link to heading">​</a></h3><p>Below is a sample configuration for Cisco CSR 1000v devices. The FlowControl system server is assumed to have the following IP address 192.168.0.100 and BGP number AS 65100. Additionally the black-hole address is 192.0.2.1</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router bgp 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bgp router-id 192.168.0.50</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 remote-as 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> address-family ipv4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> neighbor 192.168.0.100 activate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> exit-address-family</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip route 192.0.2.1 255.255.255.255 Null0</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Notes:</p><p>Both Flowcontrol and the router must be in the same AS. The RTBH feature does not work if both devices are in different AS and establish eBGP connection.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="verification-of-the-bgp-session-between-flowcontrol-and-the-router-3">Verification of the BGP session between FlowControl and the router<a class="hash-link" href="#verification-of-the-bgp-session-between-flowcontrol-and-the-router-3" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSR1000V#**show ip bgp summary** </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP router identifier 192.168.0.50, local AS number 65100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP table version is 1, main routing table version 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Neighbor    V      AS MsgRcvd MsgSent  TblVer InQ OutQ Up/Down State/PfxRcd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**192.168.0.100  4    65100    5    8    1  0  0 00:03:21    0**</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="checking-the-routing-table-on-the-router-2">Checking the routing table on the router<a class="hash-link" href="#checking-the-routing-table-on-the-router-2" title="Direct link to heading">​</a></h4><p>The following example shows contents of the routing table after FlowControl has sent to the router the black-hole IP address 192.0.2.1 as the next-hop for attacked IP address 192.168.20.1. The routing table consists of two entries: static one that directs to Null0 interface traffic destined to 192.0.2.1 address, and the dynamic BGP entry that sets next-hop for the attacked IP 192.168.20.1 to the above IP address 192.0.2.1. Effectively all the traffic destined to IP 192.168.20.1 is directed to the Null0 interface, i.e. is dropped.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSR1000V#**show ip route**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   192.0.2.0/32 is subnetted, 1 subnets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**S    192.0.2.1 is directly connected, Null0**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   192.168.20.0/32 is subnetted, 1 subnets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**B    192.168.20.1 [200/0] via 192.0.2.1, 00:00:06**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-12-17T13:05:15.000Z">17/12/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/XND module/FlowControl XND Module"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">FlowControl XND Module</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/XND module/XND module configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">XND module configuration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#spec-configuration-on-juniper" class="table-of-contents__link toc-highlight">Spec configuration on Juniper</a></li><li><a href="#flowspec-configuration-on-cisco-asr-9000-devices" class="table-of-contents__link toc-highlight">FlowSpec configuration on Cisco ASR 9000 devices</a></li><li><a href="#flowspec-configuration-on-cisco-csr-1000v" class="table-of-contents__link toc-highlight">FlowSpec configuration on Cisco CSR 1000v</a></li><li><a href="#rtbh-configuration-on-juniper" class="table-of-contents__link toc-highlight">RTBH configuration on Juniper</a></li><li><a href="#rtbh-configuration-on-cisco-asr-9000" class="table-of-contents__link toc-highlight">RTBH configuration on Cisco ASR 9000</a></li><li><a href="#rtbh-configuration-on-cisco-csr-1000v" class="table-of-contents__link toc-highlight">RTBH configuration on Cisco CSR 1000v</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Sycope</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8e163d66.js"></script>
<script src="/assets/js/main.0fa93cde.js"></script>
</body>
</html>