<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">FlowControl XND Module | flowcontrol documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://flowcontrol12.github.io/XND module/FlowControl XND Module"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="FlowControl XND Module | flowcontrol documentation"><meta data-react-helmet="true" name="description" content="Introduction to XND Module"><meta data-react-helmet="true" property="og:description" content="Introduction to XND Module"><meta data-react-helmet="true" property="og:image" content="https://flowcontrol12.github.io/img/undraw_online.svg"><meta data-react-helmet="true" name="twitter:image" content="https://flowcontrol12.github.io/img/undraw_online.svg"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://flowcontrol12.github.io/XND module/FlowControl XND Module"><link data-react-helmet="true" rel="alternate" href="https://flowcontrol12.github.io/XND module/FlowControl XND Module" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://flowcontrol12.github.io/XND module/FlowControl XND Module" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.fb053dc5.css">
<link rel="preload" href="/assets/js/runtime~main.43552c81.js" as="script">
<link rel="preload" href="/assets/js/main.f9a4b6a0.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">flowcontrol documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">flowcontrol documentation</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Installation">Installation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">XN module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Dashboards">Dashboards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/System Status">System Status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Access through REST API">Access through REST API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">XNS module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Security Dashboards">Security Dashboards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Threat Detection">Threat Detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Threat Intelligence Engine">Threat Intelligence Engine</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">XND module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/Performance">Performance</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/XND module/FlowControl XND Module">FlowControl XND Module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/DDoS Mitigation">DDoS Mitigation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/XND module configuration">XND module configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/DDoS Dashboards">DDoS Dashboards</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/CLI commands">CLI commands</a></li><li class="menu__list-item"><a class="menu__link" href="/Requirements">Requirements</a></li><li class="menu__list-item"><a class="menu__link" href="/Release notes">Release notes</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">FlowControl XND Module</h1></header><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="introduction-to-xnd-module"></a>Introduction to XND Module<a class="hash-link" href="#introduction-to-xnd-module" title="Direct link to heading">#</a></h3><p>​	The FC XND module uses aggregated NetFlow, sFlow, NSEL data. Based on this data and parameters entered by the user, the algorithm calculates a set of data defining the target together with the attacked service and can then take action to limit the effects of the attack. DDoS attacks are detected by the XND module algorithm based on the parameters: static thresholds and dynamic thresholds.</p><p><strong>Static thresholds</strong> are used to optimize and reduce the number of False Positives by filtering network traffic that do not meet quantitative parameters such as: bytes limit, packet limit or unique source IP addresses. All static threshold parameters have to be exceeded in order for the algorithm to start the next step, i.e. calculation of dynamic threshold parameters.</p><p><strong>Dynamic thresholds (behavioral)</strong> are used to compare current network traffic characteristics with the previous sample (baseline). By default, a baseline is created for 15 minutes before the attack. The dynamic threshold parameters are configured in the XND module as a so-called multiplier, which means that multiple of a given indicator cannot be exceeded. The indicator parameter specifies the number of dynamic thresholds that must be exceeded for an attack to be confirmed from the behavioral analysis point of view. </p><p>​	The DDoS mechanism also uses two types of whitelists: <strong>ASN whitelist</strong> and <strong>service whitelist</strong> <strong>– monitoring mode</strong>. The first one is used to define source ASNs to be ignored from the XND module algorithm calculation. The service whitelist, on the other hand, is used to define the services for which only DDoS alerts will be generated, and blocking will not be triggered for them using the BGP FlowSpec protocol or RTBH (Remote Triggered Black Hole Routing).</p><p>​	All parameters of the DDoS detection algorithm are configured in relation to the <strong>function group (Settings/Mapping/Groups/Function),</strong>  <em>Fig. 2.1.1.</em> Here the resources subject to the procedure contained in the XND module are configured, thus it is possible to fine-tune the XND module mechanism.</p><img src="/assets/images/image-20201112123813503-e55fbcddb44e29781bd6aa15ae19d754.png" alt="image-20201112123813503" style="zoom:67%"><p><em>Fig. 2.1.1 XND groups configuration parameters</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xdn-module-operation-diagram"></a>XDN module operation diagram<a class="hash-link" href="#xdn-module-operation-diagram" title="Direct link to heading">#</a></h3><p>The <em>Fig. 2.2.1</em> shows the operating principle and the individual analysis steps contained in the FlowControl XND module as a diagram.</p><p><img alt="image-20201112124555675" src="/assets/images/image-20201112124555675-f970ac039bf517104c25d1c15ff91de5.png"></p><p><em>Fig. 2.2.1 Concept of the DDoS algorithm implemented in XND module</em>  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="data-filtering"></a>Data filtering<a class="hash-link" href="#data-filtering" title="Direct link to heading">#</a></h3><p>​	One of the first operations performed by the XND module on input data strings is pre-filtering. Its task should be filter out redundant motion for the analysis algorithm before the grouping process. </p><p>Pre-filtration includes:</p><ol><li>Target host filtering - filters the target IP addresses of monitored resources. These addresses are configured using function groups defined in the Engine Parameters.</li><li>TCP client traffic filtering – used to filtering the incoming traffic to the monitored resource, which is a response to queries to external resources. This step is implemented in the FlowControl system engine.</li><li>Source ASN filtering – defines ASNs that are excluded from analysis by the XND Module algorithm.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="data-grouping"></a>Data Grouping<a class="hash-link" href="#data-grouping" title="Direct link to heading">#</a></h3><p>​	Another activity carried out by the XND module is the network traffic aggregation, i.e. data grouping. This operation is necessary to calculate a set of parameters that determine the target with the attacked service. In this process the following indicators are calculated:</p><ol><li>Unique IP addresses</li><li>Unique ASNs</li><li>Unique internal IP addresses</li><li>Unique public IP addresses</li><li>Flow counter </li><li>Number of packets</li><li>Number of bytes</li><li>PPF (Packets per Flow )</li><li>BPP (Bytes per Packets)</li><li>BPF (Bytes per Flow).   </li></ol><p>For a DDoS attack, each set of parameters defining the target together with the service under attack, is a combination of such attributes as: target host, protocol, application and traffic direction. The set parameters defining the target together with the service is <strong>DDoS destination attack identifier (DDA Id).</strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="static-thresholds"></a>Static thresholds<a class="hash-link" href="#static-thresholds" title="Direct link to heading">#</a></h3><p>​	The static threshold parameters are represented by the following limits: flow limit, byte limit, and unique IPs limit – <em>Table</em> <em>2.5.1.</em> They allow data selection for the analyzed sample in order to determine which data will be taken into account in further steps in the algorithm. At this stage pre-filtered network traffic from the last minute is filtered using the above mentioned limits. In case all static thresholds for a specific DDA Id are exceeded, the XND module algorithm goes to the dynamic parameters analysis procedure. In other cases the algorithm performs filtering with static thresholds for the traffic sample from the next minute.</p><table><thead><tr><th><strong>Static Threshold</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><strong>Flows Limit</strong></td><td>Minimum number of network flows related to DDA Id.</td></tr><tr><td><strong>Bytes Limit</strong></td><td>Minimum number of bytes related to DDA I expressed in [MB].</td></tr><tr><td><strong>Unique IPs Limit</strong></td><td>Minimum number of unique source IP addresses related to DDA Id.</td></tr></tbody></table><p><em>Table 2.5.1 Static threshold parameters.</em></p><p>​	Values of the static threshold parameters are configured in the Engine Parameters tab as shown in <em>Fig. 2.5.2.</em></p><p><img alt="image-20201112130154333" src="/assets/images/image-20201112130154333-64a81391486f20086858081e37c2dcac.png"></p><p><em>Fig. 2.5.2 Static threshold parameters configuration</em>  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dynamic-thresholds"></a>Dynamic thresholds<a class="hash-link" href="#dynamic-thresholds" title="Direct link to heading">#</a></h3><p>​	Ten dynamic thresholds and indicator limits are implemented in the FC XND module. They are described in <em>Table 2.6.1</em>.    </p><table><thead><tr><th>Dynamic Thresholds</th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><strong>Unique ASNs</strong></td><td>Number of unique ASNs related to DDA ID.</td></tr><tr><td><strong>Unique IPs</strong></td><td>Number of all unique source IP addresses (external and internal) related to DDA ID.</td></tr><tr><td><strong>Unique Internal IPs</strong></td><td>Number of all unique source internal IP addresses related to DDA Id. Internal (private) addresses are configured in the Settings/Mapping/Groups/Internal tab.</td></tr><tr><td><strong>Unique Public IPs</strong></td><td>Number of all unique source external IP addresses related to DDA Id.</td></tr><tr><td><strong>Flows</strong></td><td>Number of flows related to DDA ID.</td></tr><tr><td><strong>Packets</strong></td><td>Number of packets related to DDA ID.</td></tr><tr><td><strong>Bytes</strong></td><td>Number of bytes related to DDA ID.</td></tr><tr><td><strong>PPF (Packets per Flow)</strong></td><td>Number of packets per network flows calculated as sum of packets divided by sum of network flows in context of DDA ID.</td></tr><tr><td><strong>BPP (Bytes per Packet)</strong></td><td>Number of bytes per packet calculated as sum of bytes divided by sum of packets in context of DDA Id.</td></tr><tr><td><strong>BPF (Bytes per Flow)</strong></td><td>Number of bytes per flows calculated as sum of bytes divided by sum of the flows in context of DDA Id.</td></tr><tr><td><strong>Indicator Limit</strong></td><td>Threshold – specifies the number of threshold limit parameters that must be exceeded for the algorithm to consider the analysis to be positive.</td></tr></tbody></table><p><em>Table 2.6.1 Dynamic threshold parameters</em> </p><p>The value of the <strong>Indicator Limit</strong> controls parameters determining how many dynamic parameters must be exceeded for the algorithm to consider the analysis to be positive.</p><p><strong><em>Example:</em></strong>  <em>“Indicators limit = 2” - this means that only two out of ten parameters of the dynamic threshold limits listed in Table 2.6.1 are exceeded for the algorithm to give a positive result.</em></p><blockquote><p><strong>Note</strong>: for the parameter “Indicators limit =0” the algorithm for dynamic analysis always gives a positive result!</p></blockquote><p>​	Values of the dynamic threshold parameters from are configured in the Engine Parameters tab as shown in <em>Fig. 2.6.1.</em></p><p><img alt="image-20201112130232708" src="/assets/images/image-20201112130232708-b2238f541b2e1e97527f22abaeb7658a.png"></p><p><em>Fig. 2.6.1 Dynamic threshold parameters configuration</em> </p><p>​	Dynamic threshold parameters are calculated using analysis behavioral mechanism for defined function groups. This mechanism uses data from time intervals preceding the analyzed sample - so-called reference data. This is base data which is used to calculate average values for a set of metrics necessary to detect DDoS attacks. A reference data is data averaged from the last fifteen minutes preceding the analyzed sample. This is used in the comparison process with the analyzed data to calculate dynamic threshold parameters. <em>Fig. 2.6.2</em> shows time intervals used to calculate dynamic threshold parameters. </p><img src="/assets/images/image-20201112130304664-d7f57c1ae50e6561a06952b73e0c6aa1.png" alt="image-20201112130304664" style="zoom:80%"><p><em>Fig. 2.6.2 Time intervals for determining reference and analysed data</em></p><p>The dynamic thresholds during an ongoing attack are calculated by the algorithm in a different way than at the beginning of the attack. In such a case the value of each dynamic threshold parameter exceeded must be less than half of the threshold value set by the user for it to be treated as an unexceeded parameter.</p><hr><blockquote><p><strong>NOTE:</strong></p><p><strong>For the DDoS algorithm to work correctly, you must set the values for all Engine Parameters, both static <em>(Fig. 2.5.2)</em> and dynamic <em>(Fig. 2.6.1).</em></strong></p></blockquote><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xnd-module-response-to-the-ddos-attacks"></a>XND module response to the DDoS attacks<a class="hash-link" href="#xnd-module-response-to-the-ddos-attacks" title="Direct link to heading">#</a></h3><p>​	In the next step of the algorithm implementation, depending on the configuration of the XND module, one of two actions can take place according to <em>Fig. 2.2.1</em>:</p><ol><li>Generating an alarm and block the offending traffic on routers using FlowSpec or RTBH functionality.</li><li>Generating an alarm only if the service has been entered on the service whitelist.</li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2021-08-31T14:33:15.000Z">8/31/2021</time></b> by <b>fcadmin</b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/XND module/Performance"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Performance</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/XND module/DDoS Mitigation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DDoS Mitigation »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-xnd-module" class="table-of-contents__link">Introduction to XND Module</a></li><li><a href="#xdn-module-operation-diagram" class="table-of-contents__link">XDN module operation diagram</a></li><li><a href="#data-filtering" class="table-of-contents__link">Data filtering</a></li><li><a href="#data-grouping" class="table-of-contents__link">Data Grouping</a></li><li><a href="#static-thresholds" class="table-of-contents__link">Static thresholds</a></li><li><a href="#dynamic-thresholds" class="table-of-contents__link">Dynamic thresholds</a></li><li><a href="#xnd-module-response-to-the-ddos-attacks" class="table-of-contents__link">XND module response to the DDoS attacks</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Sycope</div></div></div></footer></div>
<script src="/assets/js/runtime~main.43552c81.js"></script>
<script src="/assets/js/main.f9a4b6a0.js"></script>
</body>
</html>