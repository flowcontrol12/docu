<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="search" type="application/opensearchdescription+xml" title="Sycope Documentation" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">XND module configuration | Sycope Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://documentation.sycope.com/XND module/XND module configuration"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="1.6"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-1.6"><meta data-react-helmet="true" property="og:title" content="XND module configuration | Sycope Documentation"><meta data-react-helmet="true" name="description" content="Introduction to XND configuration"><meta data-react-helmet="true" property="og:description" content="Introduction to XND configuration"><meta data-react-helmet="true" property="og:image" content="https://documentation.sycope.com/img/undraw_online.svg"><meta data-react-helmet="true" name="twitter:image" content="https://documentation.sycope.com/img/undraw_online.svg"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://documentation.sycope.com/XND module/XND module configuration"><link data-react-helmet="true" rel="alternate" href="https://documentation.sycope.com/XND module/XND module configuration" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://documentation.sycope.com/XND module/XND module configuration" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://VTLMOZMQ8V-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.bbb1dc82.css">
<link rel="preload" href="/assets/js/runtime~main.23ade26e.js" as="script">
<link rel="preload" href="/assets/js/main.df53a46d.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">flowcontrol documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">1.6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/Coming soon">2.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/XND module/XND module configuration">1.6</a></li></ul></div><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_xXbB"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-sycope.svg" alt="flowcontrol documentation" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">flowcontrol documentation</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/next/Coming soon">2.0</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/XND module/XND module configuration">1.6</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Installation">Installation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">XN module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Dashboards">Dashboards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/System Status">System Status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XN module/Access through REST API">Access through REST API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">XNS module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Security Dashboards">Security Dashboards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Threat Detection">Threat Detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XNS module/Threat Intelligence Engine">Threat Intelligence Engine</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">XND module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/Performance">Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/FlowControl XND Module">FlowControl XND Module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/DDoS Mitigation">DDoS Mitigation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/XND module/XND module configuration">XND module configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XND module/DDoS Dashboards">DDoS Dashboards</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/CLI commands">CLI commands</a></li><li class="menu__list-item"><a class="menu__link" href="/Requirements">Requirements</a></li><li class="menu__list-item"><a class="menu__link" href="/Release notes">Release notes</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: 1.6</span><div class="markdown"><header><h1 class="h1Heading_27L5">XND module configuration</h1></header><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="introduction-to-xnd-configuration"></a>Introduction to XND configuration<a class="hash-link" href="#introduction-to-xnd-configuration" title="Direct link to heading">#</a></h3><p>The following section describes the configuration procedure for the detection mechanism and prevention of DDoS attacks implemented in the XND module. This mechanism extends XNS (Security) module capabilities with advanced detection algorithms and defense mechanisms against DDoS attacks.</p><p>Detection of DDoS attacks can be performed by the security threat detection engine (XNS module) as well as an advanced mechanism to detect and prevent DDoS attacks (XND module). The list of rules for detecting DDoS attacks in XNS module can be found below in <em>Table 4.1.1.</em></p><table><thead><tr><th><strong>Rule Name</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><strong>DDoS Attack Detected</strong></td><td>This rule detects DDoS Attacks based on traffic volume from multiple IP addresses to a single destination IP on the same port. The attack involves saturating network resources causing disruption of normal traffic on the target server. For the rule to work correctly, configure the Counter Threshold and Whitelist groups.</td></tr><tr><td><strong>DDoS DNS Amplification Attack</strong></td><td>This rule detects DDoS DNS Amplification Attacks based on network traffic statistics (Signature 1). To create heavy traffic, an attacker sends a request in a way that generates the largest possible response from DNS name resolution services. As a result, the target receives reinforcement of the initial attacker&#x27;s traffic, and their network is clogged with false traffic, which causes denial of service. For the rule to work correctly, configure the following attributes: Flow Count and PPF (Packets Per Flow).</td></tr><tr><td><strong>DoS Attack Detected</strong></td><td>This rule detects DoS Attacks based on traffic volume from one IP address to single IPs on a specific port. For the  rule to work correctly, configure the Port Threshold List format as follows:  Flows_Threshold\ Port\ Service and Whitelist groups.</td></tr><tr><td><strong>DoS - ICMP                                             Flood</strong></td><td>This rule detects DoS ICMP attacks. An attacker can send a large number of ICMP packets to consume all available bandwidth of a victim&#x27;s host. For the rule to work correctly, configure the following attributes: Flow Count, PPF (Packets per Flow), PPM (Packets Per Minute) and Whitelist groups.</td></tr><tr><td><strong>DoS - TCP</strong>                                                              <strong>Flood</strong></td><td>This rule detects TCP DoS attacks. An attacker can send a large number of TCP packets to one or several ports of the victim, which eventually renders the attacked host unable to process the incoming packets. For the rule to work correctly, configure the following attributes: Flow Count, PPF (Packets per Flow), PPM (Packets Per Minute) and Whitelist groups.</td></tr><tr><td><strong>DoS - UDP</strong>                <strong>Flood</strong></td><td>This rule detects DoS UDP attacks. An attacker can send a large number of UDP packets to consume all available bandwidth of the victim&#x27;s host. For the rule to work correctly, configure the following attributes: Flow Count, PPF (Packets per Flow), PPM (Packets Per  Minute) and Whitelist groups.</td></tr></tbody></table><p><em>Table 4.1.1 DDoS rules list in</em> <em>XNS module</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="xnd-module-configuration-steps"></a>XND module configuration steps<a class="hash-link" href="#xnd-module-configuration-steps" title="Direct link to heading">#</a></h3><ol><li>Create function groups (to be used in the XND mechanism) in the network map (Settings/Mapping/Groups/Function). A function group is a group of IP addresses that is monitored. The function group can be given its own name (<em>Fig. 4.2.1</em>). </li></ol><p><img alt="image-20201112130355880" src="/assets/images/image-20201112130355880-a5dae77325173259d0424e4254472ccd.png"></p><p><em>Fig. 4.2.1 Function group configuration</em></p><ol start="2"><li>Configure XND basic module (<em>Fig. 4.2.2</em>)</li></ol><p><img alt="image-20201112130435787" src="/assets/images/image-20201112130435787-99c466a1e1d029b01111057c6a35a1d7.png"></p><p><em>Fig. 4.2.2 DDoS basic configuration</em></p><table><thead><tr><th align="left">Rule  Attribute</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">Enabled</td><td align="left">Determining whether the rule is enabled</td></tr><tr><td align="left">Alert Name</td><td align="left">The name of the rule is “DDoS Attack Detected – XND”, but the name of the alarms of this rule are START: DDoS Attack Detected  - XND&quot; and &quot;STOP: DDoS Attack Detected - XND&quot;.</td></tr><tr><td align="left">Threat  Category</td><td align="left">Threat category according to FlowControl nomenclature.</td></tr><tr><td align="left">Score</td><td align="left">Criticality of alarm on a scale 1-10: 10-9 Critical, 8-7 High, 6-4 Medium, 3-2 Low.</td></tr><tr><td align="left">MITRE Tactic</td><td align="left">Tactical name according to MITRE technique.</td></tr><tr><td align="left">MITRE  Technique</td><td align="left">Technique name according to MITRE technique.</td></tr><tr><td align="left">ASN  Whitelist</td><td align="left">Whitelist of source ASNs, i.e. ASNs to filtered out of by XND module mechanism.</td></tr><tr><td align="left">Service  Whitelist</td><td align="left">List of services excluded from the attack mitigation mechanism – alerts are still generated. Examples of Whitelist records: <br> (1)      (Destination_IP,Port)  – blocks the selected services for specified IP address <br> (2)      (Destination_IP,<em>)  – blocks all services for the specified IP address<br> (3)      (Subnet,Port)  – blocks the service for hosts in specified subnet<br>  </em> means all ports</td></tr></tbody></table><p><em>Table 4.2.1 XND module DDoS basic configuration</em></p><ol start="3"><li>Configure DDoS parameters for individual function groups (<em>Fig. 4.2.3, Fig. 4.2.4</em>)</li></ol><p><img alt="image-20201112130508003" src="/assets/images/image-20201112130508003-7b2ae0c81f67ae0b9628da893cc35066.png"></p><p><em>Fig. 4.2.3 Configuration of a DDoS parameters for monitored groups.</em></p><p><img alt="image-20201112130536345" src="/assets/images/image-20201112130536345-dd30eebc46d8575c3b77d89c6fc551c0.png"></p><p><em>Fig. 4.2.4 DDoS parameters configuration for selected function groups</em>.</p><ol start="4"><li>Configure DDoS Mitigation (<em>Fig. 4.2.5</em>)</li></ol><p><img alt="image-20210620134554280" src="/assets/images/image-20210620134554280-0fb54222314ddbf45456828ed58e0799.png"></p><p><em>Fig. 4.2.5 FlowSpec BGP configuration</em></p><p><strong>BGP NEIGHBORS</strong></p><table><thead><tr><th align="left">Configuration  Attribute</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">Enabled</td><td align="left">Enabled/Disabled BGP support</td></tr><tr><td align="left">FCXN AS</td><td align="left">BGP ASN number of FCXN system</td></tr><tr><td align="left">FCXN BGP Port</td><td align="left">BGP port of FCXN system</td></tr><tr><td align="left">FCXN BGP ID</td><td align="left">BGP ID of FCXN system</td></tr><tr><td align="left">Blackhole IP (RTHB)</td><td align="left">Blackhole IP address. Static route must be configured on the router that re-directs traffic destined to this IP to Null or discard interface.</td></tr><tr><td align="left">Neighbor IP</td><td align="left">IP address of the neighboring router</td></tr><tr><td align="left">Neighbor AS</td><td align="left">BGP ASN number of the neighboring router</td></tr><tr><td align="left">BGP Hold Time</td><td align="left">BGP Hold Time interval of FCXN system</td></tr><tr><td align="left">Mode</td><td align="left">Mitigation type: FlowSpec or RTBH</td></tr><tr><td align="left">Status</td><td align="left">BGP connection status:<br><u><em>Listening /  Waiting for connection</em></u> - System FCXN waiting for BGP connection to be initiated by the router. Not  connected: remote AS different than expected (LocalAS) – disconnected. ASN number given is different from that configured on the router.    <br><u><em>Disconnected by neighbor</em></u> – BGP connection was interrupted by the router. After a few seconds the status should change to “Waiting for connection”. <br><u><em>Disconnected</em></u> – BGP connection was interrupted by the FCXN system (e.g. after changing the settings). After a few seconds the status should change to  “Waiting for connection”.    <br><u><em>Disconnected: other error (report to Tech  Support)</em></u> – BGP connection interrupted for other reasons. After a few seconds the status should change to  “Waiting for connection”.  <br><u><em>Connected</em></u> – BGP connection established with the router. The field may contain additional information:    <br><em> actual HoldTime different than expected – Hold Time parameter give in the settings is different from that configured on the router.  <br></em> not sending IPv4/IPv6 AS paths – Path option is enabled, but the router is not configured to send BGP ASN tracks.   <br><em> exported IPv4/IPv6 AS paths ignored – Router is configured to send BGP ASN tracks, but Paths option is disabled. Paths are ignored.   <br></em> no FlowSpec IPv4/IPv6 support – FlowSpec option is enabled, but the router does not support this protocol.   <br>* FlowSpec IPv4/IPv6 support can be turned off – Router supports FlowSpec, but in FCXN settings this option is disabled. FlowSpec rules are not sent to the router.</td></tr></tbody></table><p><em>Table 4.2.2 BGP FlowSpec configuration parameters</em></p><h3></h3><p><em>Click the ADD NEW button and configure router</em> </p><p><img alt="mage-20201113150507633" src="/assets/images/image-20201113150507633-06df5b4303425b45af242dabc2d20ca0.png"></p><table><thead><tr><th>Configuration  Attribute</th><th>Description</th></tr></thead><tbody><tr><td>Neighbor IP</td><td>IP address of the neighboring router</td></tr><tr><td>Neighbor AS</td><td>BGP ASN number of the neighboring router</td></tr><tr><td>BGP Hold Time</td><td>BGP Hold Time interval of FCXN system</td></tr><tr><td>Paths</td><td>(Not implemented  yet)</td></tr><tr><td>Mode</td><td>Mitigation type: FlowSpec, RTBH or None</td></tr></tbody></table><p><strong>MANUAL BLOK IP</strong></p><p><em>Click the ADD NEW button and configure Manual Block IP</em> </p><p><img alt="image-20210620135650109" src="/assets/images/image-20210620135650109-14aff9854633c4eb4d224f97ca044527.png"></p><table><thead><tr><th align="left">Configuration  Attribute</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">Dst. IP</td><td align="left">Destination IP address with a mask (IP/Mask)</td></tr><tr><td align="left">Dst. Port</td><td align="left">Destination port (0-65535)</td></tr><tr><td align="left">Src. IP</td><td align="left">Source IP address with a mask (IP/Mask)</td></tr><tr><td align="left">Src. Port</td><td align="left">Source port (0-65535)</td></tr><tr><td align="left">Description</td><td align="left">Rule description (Text)</td></tr><tr><td align="left">User</td><td align="left">Filled automatically</td></tr><tr><td align="left">Added Time</td><td align="left">Filled automatically</td></tr></tbody></table><p>6) Check which services are blocked by BGP FlowSpec (<em>Fig. 4.2.6</em>).</p><p><img alt="image-20201112130645504" src="/assets/images/image-20201112130645504-33d3042c094cab0ffca5200314f0ac79.png"></p><p><em>Fig. 4.2.6 Displaying services blocked by</em> <em>BGB FlowSpec</em></p><p><img alt="image-20210620135650109" src="/assets/images/image-20210620135650109-14aff9854633c4eb4d224f97ca044527.png"></p></div><footer class="row docusaurus-mt-lg"><div class="col"></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2021-12-17T13:05:15.000Z">12/17/2021</time></b> by <b>Jan Horubała</b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/XND module/DDoS Mitigation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« DDoS Mitigation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/XND module/DDoS Dashboards"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DDoS Dashboards »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-xnd-configuration" class="table-of-contents__link">Introduction to XND configuration</a></li><li><a href="#xnd-module-configuration-steps" class="table-of-contents__link">XND module configuration steps</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Sycope</div></div></div></footer></div>
<script src="/assets/js/runtime~main.23ade26e.js"></script>
<script src="/assets/js/main.df53a46d.js"></script>
</body>
</html>