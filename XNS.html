<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>XNS module · flowcontrol documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="### Introduction"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="XNS module · flowcontrol documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://flowcontrol12.github.io/"/><meta property="og:description" content="### Introduction"/><meta property="og:image" content="https://flowcontrol12.github.io/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://flowcontrol12.github.io/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/theme-live-codeblock.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo-sycope.svg" alt="flowcontrol documentation"/><h2 class="headerTitleWithLogo">flowcontrol documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher singleRowMobileNav"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>XNS module</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Installation Guide</h3><ul class=""><li class="navListItem"><a class="navItem" href="/Inst_g">Installation Procedure</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">XN module</h3><ul class=""><li class="navListItem"><a class="navItem" href="/XN">XN User Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">XNS module</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/XNS">XNS User Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">XND module</h3><ul class=""><li class="navListItem"><a class="navItem" href="/XND">XND User Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Command Line Interface</h3><ul class=""><li class="navListItem"><a class="navItem" href="/CLI">CLI commands</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">System Requirements</h3><ul class=""><li class="navListItem"><a class="navItem" href="/Req">Requirements</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Release Note</h3><ul class=""><li class="navListItem"><a class="navItem" href="/Rel">Release notes</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h3><a class="anchor" aria-hidden="true" id="introduction"></a><a href="#introduction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<hr>
<p>FlowControl XNS detects and analyses security threats and anomalies in a context of the entire organization based on network metadata (NetFlow) and reputation lists. For effective detection of abnormal activities, XNS uses two engines:</p>
<p>•       Threat Intelligence (TI)</p>
<p>•       Threat Detection (TD).</p>
<p>The former detects malicious or illegal activity based on correlations with reputation lists of malicious IP addresses and suspicious countries. However, Threat Detection detects security threats and anomalies based on the correlation and aggregation of relationships between the values of various parameters of network artifacts within a specified period of time.</p>
<p>A set of rules built into the system makes it easier to monitor prohibited and malicious activities in an organization.</p>
<p>Key features of XNS include:</p>
<p>•       Using the ATT&amp;CK MITRE methodology to enrich information on alerts and categorization of security threats detected in XNS</p>
<p>•       Using built-in threat detection mechanisms to discover malicious activities in the context of the whole organization</p>
<p>•       Limiting the number of false positives due to the ability to whitelist specific properties in security rules</p>
<p>•       Integrating with external databases to check the reputation of the host, e.g. Virustotal</p>
<p>•       Improving the visibility of threats in the context of individual parts of the organization, which is an added value for each SOC &amp; NOC teams</p>
<p>•       Correlating multiple network artifacts to detect suspicious activity and security breaches</p>
<p>•       Improving the MTTD* indicator due to properly designed views, e.g. SOC Dashboard</p>
<p>•       Enrichment of data with valuable information facilitating threat analysis, e.g. ASN, geolocation, IoC</p>
<p>•       Helping CSO and Security Managers make decisions through KPI views</p>
<p>•       Supporting many security processes, such as for example incident handling, network forensics, threat hunting</p>
<p>•       Supporting process of meeting compliance with regulations and standards, e.g. <a href="http://prawo.sejm.gov.pl/isap.nsf/download.xsp/WDU20180001560/T/D20181560L.pdf">UoKSC (Ustawa o Krajowym Systemie Cyberbezpieczeństwa)</a>,</p>
<p>•       Improving network and security troubleshooting process</p>
<p>•       Detecting correlations between systems thanks to integration with SIEMs</p>
<p>•       Updating security rules and IoC regularly.</p>
<p>*MTTD (Mean Time To Detect) - amount of time it takes the Security Team to discover a potential security incident.</p>
<p>FlowControl XNS generates security alerts which are categorized by tactics and techniques of the MITRE ATT&amp;CK methodology. Below is a brief description of this methodology.</p>
<p>MITRE ATT&amp;CK™ is a globally-accessible knowledge base of adversary tactics and techniques based on real-world observations. The ATT&amp;CK knowledge base is used as a foundation for the development of specific threat models and methodologies in the private sector, in government, and in the cybersecurity product and service community. Full MITRE ATT&amp;CK Matrice is available on the <a href="https:/attack.mitre.org/">MITRE ATT&amp;CK Matrices</a> website. The MITRE ATT&amp;CK Enterprise Matrice contains many techniques grouped into tactics (<em>Fig. I.1</em>).</p>
<p><img src="/assets/image-20201218120633426.png" alt="image-20201218120633426"></p>
<p><em>Fig.. I.1 MITRE ATT&amp;CK Tactics. Source: <a href="https:/attack.mitre.org/">MITRE ATT&amp;CK.</a></em></p>
<p>Examples of security threats and anomalies detected by FlowControl XNS and categorized by MITRE ATT&amp;CK are described in the <em>Tab I.1.</em></p>
<table>
<thead>
<tr><th>MITRE ATT&amp;CK Tactic</th><th><strong>Security Threats Examples</strong></th></tr>
</thead>
<tbody>
<tr><td><strong>Initial Access</strong></td><td>Detection of unauthorized P2P network activities.</td></tr>
<tr><td><strong>Credential Access</strong></td><td>Detection of brute force attacks on various  services, e.g. HTTP(s), FTP, IMAP, SSH, RDP, LDAPS, MS SQL Detection of  unauthorized LLMNR / NetBIOS communications.</td></tr>
<tr><td><strong>Discovery</strong></td><td>Detection of unauthorized access to certain services, e.g. DHCP, DNS, Mail Server Network scan detection, Host scan detection, Detecting malware spread, Detection of network anomalies that may be related to security.</td></tr>
<tr><td><strong>Lateral Movement</strong></td><td>Detection of unauthorized RDP connections.</td></tr>
<tr><td><strong>Command And Control (C2)</strong></td><td>Detection of activity on suspicious ports  (based on Black and White-lists), Detection of unencrypted connections to critical servers or services, Detection of communication with suspicious IP addresses, e.g. Botnet, Malware, C2, Ransomware Detection of violations of security policies, e.g. TOR, Open DNS, Open Proxy.</td></tr>
<tr><td><strong>Exfiltration</strong></td><td>Detection of DNS anomalies, e.g. Abnormal DNS Query Limit, Abnormal DNS Response Limit, DNS Transfer Limit Detecting a large number of unsolicited emails (SPAM), Detection of data exfiltration attempts, Detection of huge amounts of data transfers within a short period of time to / from an organization, Detection of anomalies in network protocols.</td></tr>
<tr><td><strong>Impact</strong></td><td>Detection of DoS attacks, e.g. ICMP Flood, TCP Flood, UDP Flood Detection of DDoS amplification attacks, e.g. DNS  Amplification</td></tr>
</tbody>
</table>
<p><em>Tab. I.1 Examples of security threats and anomalies detected by FlowControl XNS and categorized by MITRE ATT&amp;CK.</em></p>
<p>FlowControl XNS analyses network flows to detect suspicious activity.</p>
<p>A flow is defined as a unidirectional sequence of packets with some common properties that pass through a network device. These collected flows are exported to an external device, the NetFlow collector. Network flows are highly granular; for example, flow records include details such as IP addresses, packet and byte counts, timestamps, Type of Service (ToS), application ports, input and output interfaces, etc.</p>
<p>Source: <a href="https://www.ietf.org/rfc/rfc3954.txt">RFC3954</a></p>
<p>The system supports the following flow protocol data sources:</p>
<p>•       NetFlow v5</p>
<p>•       NetFlow v9</p>
<p>•       sFlow</p>
<p>•       IPFIX</p>
<p>•       NSEL.</p>
<p><strong>Note:</strong> Specific options such as NSEL (Cisco ASA) or different sampling multipliers per device must be additionally configured. This system uses SNMP v1/2/3 to query devices.</p>
<p>According to the RFC3964, FlowControl solution works as a Flow Collector (both hardware and software versions are available) which collects, analyses and visualizes the collected flows. Metrics are presented and examined from two perspectives: Network and Security giving the operator valuable input into network/application problems analysis as well as hunting security threats (<em>Fig. I.2</em>).</p>
<p><img src="/assets/sycope_flowcontrol_1_5-1604661807668.jpg" alt="sycope_flowcontrol_1_5"></p>
<p><em>Fig. I.2 Netflow Collector – logical architecture.</em></p>
<h2><a class="anchor" aria-hidden="true" id="1-security-dashboards"></a><a href="#1-security-dashboards" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Security Dashboards</h2>
<p>FlowControl XNS contains four menus (<em>Fig. 1.1)</em> of views for effective analysis of detected security threats:
•       SOC
•       KPIs
•       Use Cases
•       Alerts.</p>
<p><img src="assets/2020-11-06_11-02-21.png" alt="2020-11-06_11-02-21" style="zoom: 80%;" /></p>
<p><em>Fig. 1.1 XNS menus</em>.</p>
<p>Each of them has a set of dedicated tabs and dashboards that are appropriately used to monitor the security of the organization.</p>
<p><em>Tab. 1.1</em>. contains a summary description of each menu.</p>
<table>
<thead>
<tr><th>View Name</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>SOC</td><td>A set of dashboards presenting security threats in the context of Tactic, IP, Group, Direction, Application, Country and Technique for the last hour. These charts are great for security departments like SOC who deal with 24/7 security monitoring.</td></tr>
<tr><td>KPIs</td><td>A set of KPIs to help security managers monitor security risk trends, risk analysis, and make key decisions.</td></tr>
<tr><td>Use Cases</td><td>A set of dashboards enabling a very detailed investigating of security threats. In order to precisely analyse specific threats, these dashboards have been divided into three Use Cases: Threat Analysis, External Threats and Internal Threats.</td></tr>
<tr><td>Alerts</td><td>A set of dashboards containing a list of security alerts and a series of data enriching them through correlation with  ATT&amp;CK MITRE knowledge base.</td></tr>
</tbody>
</table>
<p><em>Tab. 1.1 Summary description of the XNS module menu</em>.</p>
<p>In the following sections, individual dashboards are discussed in more detail.</p>
<h3><a class="anchor" aria-hidden="true" id="11-soc"></a><a href="#11-soc" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.1. SOC</h3>
<p>The SOC dashboards are great for security departments like SOC who deal with 24/7 security monitoring. <em>Tab. 1.1.1</em> contains a summary description of each SOC tabs.</p>
<table>
<thead>
<tr><th>Dashboard Name</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Overview</td><td>A basic view for SOC analysts containing information about the last hour's threats in the context of Tactic, Group,  IP, Attack Directions and Applications.</td></tr>
<tr><td>TOP IPs</td><td>Charts showing most common attributes, such as Source and Destination Hosts or Source-Destination IP Pairs, which are found in security alerts.</td></tr>
<tr><td>TOPs</td><td>Charts containing statistics on network artifacts related to detected threats, such as the number of alerts in the  context of Source-Destination Group pairs, the number of individual security alerts and the number of alerts together with the number of unique Source Hostnames for each attack Technique.</td></tr>
</tbody>
</table>
<p><em>Tab. 1.1.1 Summary description of the SOC tabs</em>.</p>
<p><em>Fig. 1.1.1-1.1.3</em> shows the individual dashboards of the SOC menu.</p>
<p><img src="/assets/image-20201106105548242.png" alt="image-20201106105548242"></p>
<p><em>Fig. 1.1.1 SOC menu Overview dashboard.</em></p>
<p><img src="/assets/image-20201106105809517.png" alt="image-20201106105809517"></p>
<p><em>Fig. 1.1.2 SOC menu TOP IPs dashboard.</em></p>
<p><img src="/assets/image-20201106111000101.png" alt="image-20201106111000101"></p>
<p><em>Fig. 1.1.3 SOC menu TOPs dashboard.</em></p>
<h3><a class="anchor" aria-hidden="true" id="12-kpis"></a><a href="#12-kpis" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.2. KPIs</h3>
<p>The KPIs dashboards facilitate the process of monitoring security risk trends based on the threats detected in the XNS module. These indicators are presented on a weekly basis, comparing specific attributes to specific days of the week. Tracking risk trends makes it easier to make decisions regarding remedial actions, which is an added value for security managers.</p>
<p>The indicators have been grouped into four categories: Severity, Host, Tactic and Module. <em>Tab. 1.2.1</em> contains descriptions of each individual indicators.</p>
<table>
<thead>
<tr><th>Dashboard Name</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Risk by Severity</td><td>KPIs for detecting security threat trends in the context of their criticality.</td></tr>
<tr><td>Risk by Host</td><td>KPIs for detecting threat trends in the context of the number of affected hosts.</td></tr>
<tr><td>Risk by Tactic</td><td>KPIs for detecting threat trends in the context of Tactics, Techniques and Alert Names.</td></tr>
<tr><td>Risk by Module</td><td>KPIs for detecting threat trends in the context of both security engines: Threat Detection and Threat Intelligence.</td></tr>
</tbody>
</table>
<p><em>Tab. 1.2.1 XNS KPIs individual indicators descriptions</em>.</p>
<p><em>Fig. 1.2.1-1.2.6</em> shows the individual dashboards of the KPIs menu.</p>
<p><img src="/assets/image-20201106111155361.png" alt="image-20201106111155361"></p>
<p><em>Fig. 1.2.1 KPIs menu Risk by Severity dashboard.</em></p>
<p><img src="/assets/image-20201106111230123.png" alt="image-20201106111230123"></p>
<p><em>Fig. 1.2.2 KPIs menu Risk by Host dashboard.</em></p>
<p><img src="/assets/image-20201106111301518.png" alt="image-20201106111301518"></p>
<p><em>Fig. 1.2.3  - KPIs menu Risk by Tactic / Tactic dashboard.</em></p>
<p><img src="/assets/image-20201106111325526.png" alt="image-20201106111325526"></p>
<p><em>Fig. 1.2.4 KPIs menu Risk by Tactic/Technique dashboard.</em></p>
<p><img src="/assets/image-20201106111343859.png" alt="image-20201106111343859"></p>
<p><em>Fig. 1.2.5 KPIs menu Risk by Tactic/Alerts dashboard.</em></p>
<p><img src="/assets/image-20201106111405548.png" alt="image-20201106111405548"></p>
<p><em>Fig. 1.2.6 KPIs menu Risk by Module dashboard.</em></p>
<h3><a class="anchor" aria-hidden="true" id="13-use-cases"></a><a href="#13-use-cases" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.3. Use Cases</h3>
<p>The scenarios implemented in the XNS module facilitate the process of analysis and drawing conclusions regarding the most important aspects related to the security of the monitored organization. The Use Cases menu is divided into the following three submenus: Threat Analysis, External Threats, Internal Threats which are described in the <em>Tab 1.3.1</em>.</p>
<table>
<thead>
<tr><th>Use Case</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Threat Analysis</td><td>The threat analysis scenario allows you to identify the most suspicious IP addresses and then examine correlations with other addresses and network artifacts to conduct a deep analysis.</td></tr>
<tr><td>External Threats</td><td>The external threats scenario is used to analyse external attacks enabling multi-dimensional analysis of one or a group of suspicious IP addresses or countries, as well as other network artifacts.</td></tr>
<tr><td>Internal Threats</td><td>The internal threats scenario is used to analyse internal attacks enabling multi-dimensional analysis of one or a group of suspicious IP addresses, as well as other network artifacts.</td></tr>
</tbody>
</table>
<p><em>Tab. 1.3.1 Use Cases submenu individual descriptions</em>.</p>
<h4><a class="anchor" aria-hidden="true" id="131-threat-analysis"></a><a href="#131-threat-analysis" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.3.1. Threat Analysis</h4>
<p>The Threat Analysis dashboards allow multi-level analysis of all security threats, regardless of whether they come from outside or inside the organization. They are described in the <em>Tab. 1.3.1.1</em>.</p>
<table>
<thead>
<tr><th>Dashboard Name</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Alerts Drilldown</td><td>An interactive dashboard containing a drilldown table with expandable attributes for criticality and IP addresses,  and a graph of connections between individual IP addresses. Security threats can be searched and analysed based on many attributes, such as Severity, Source Host, Destination Host, Security Module, Tactic, Technique, Alert Name, Threat Category, Application, Direction, Source Group, Destination Group, Source Country, Destination Country or Feed ID. Presenting threats in the context of these attributes facilitates an effective review of organizational security risks.</td></tr>
<tr><td>TOP Suspicious IPs</td><td>Charts presenting the most suspicious hosts in an organization in the context of attackers and victims of attacks. The suspicion index is calculated based on a vendor internal algorithm. In addition, this dashboard contains the association of suspicious IP addresses with Alert Names.</td></tr>
<tr><td>IPs Correlation</td><td>Graphic visualization of connections between Source and Destination Hosts, also in other attribute contexts, such as Alert Name or Application.</td></tr>
<tr><td>Groups Correlation</td><td>Graphic visualization of connections between Source and Destination Groups, also in other attribute contexts, such  as Alert Name or Threat Category.</td></tr>
<tr><td>Countries Correlation</td><td>Graphic visualization of connections between Source and Destination Countries, also in other attribute contexts, such as Groups (Source and Destination) or Threat Categories.</td></tr>
<tr><td>BOTTOMs</td><td>A set of views presenting information about threats in the context of the most rare parameters, e.g. Source-Destination pair of Groups, Source-Destination pair of Hosts, Applications and Alert Names.</td></tr>
<tr><td>Alerts Statistics</td><td>A scatter plot of the relationship between the number of Alert Names and Destination Hosts.</td></tr>
</tbody>
</table>
<p><em>Tab. 1.3.1.1 Threat Analysis submenu dashboard description.</em></p>
<p><em>Fig. 1.3.1.1 -1.3.1.7</em> Shows individual dashboards from Threat Analysis submenu.</p>
<p><img src="/assets/image-20201106111538376.png" alt="image-20201106111538376"></p>
<p><em>Fig. 1.3.1.1 Threat Analysis - Alerts Drilldown dashboard.</em></p>
<p><img src="/assets/image-20201106111600400.png" alt="image-20201106111600400"></p>
<p><em>Fig. 1.3.1.2  Threat Analysis - TOP Suspicious IPs dashboard.</em></p>
<p><img src="/assets/image-20201106111650298.png" alt="image-20201106111650298"></p>
<p><em>Fig. 1.3.1.3 Threat Analysis - IPs Correlation dashboard.</em></p>
<p><img src="/assets/image-20201106111709571.png" alt="image-20201106111709571"></p>
<p><em>Fig. 1.3.1.4 Threat Analysis - Groups Correlation dashboard.</em></p>
<p>![image-20201215143002272](/home/ted/ExpanDrive/OneDrive/PRACA/_1Passus/Strona dokumentacja bieżąca/v1.5.2 candidate/assets/image-20201215143002272.png)</p>
<p><em>Fig. 1.3.1.5 Threat Analysis - Countries Correlation dashboard</em></p>
<p><img src="/assets/image-20201106111928569.png" alt="image-20201106111928569"></p>
<p><em>Fig. 1.3.1.6 Threat Analysis - BOTTOMs dashboard.</em></p>
<p><img src="/assets/image-20201106111953012.png" alt="image-20201106111953012"></p>
<p><em>Fig. 1.3.1.7 Threat Analysis - Alerts Statistics dashboard</em>.</p>
<h4><a class="anchor" aria-hidden="true" id="132-external-alerts"></a><a href="#132-external-alerts" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.3.2. External Alerts</h4>
<p>External Threats dashboards focus on presenting artifacts related to security threats from outside the organization. <em>Tab. 1.3.2.1</em> contains descriptions of individual dashboards.</p>
<table>
<thead>
<tr><th>Dashboard Name</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Alerts Drilldown</td><td>An interactive view containing a drilldown table with expandable attributes for criticality and IP addresses, and a  graph of connections between individual IP addresses. Security threats can be  searched and analysed based on many attributes, such as Severity, Source Host, Destination Host, Tactic, Technique, Alert Name, Direction,  Application, Source Country, Destination Country, Source Group and  Destination Group.</td></tr>
<tr><td>Alerts Data Size</td><td>A world map showing the amount of data sent in the context of individual Countries when security alerts are triggered.</td></tr>
<tr><td>Alerts Map</td><td>A world map showing the number of individual Techniques in the context of the Country associated with the source of a specific Technique.</td></tr>
</tbody>
</table>
<p><em>Tab. 1.3.2.1 Use Cases - External Threats</em></p>
<p><img src="/assets/image-20201106112051083.png" alt="image-20201106112051083"></p>
<p><em>Fig. 1.3.2.1 External Threats - Alerts Drilldown dashboard.</em></p>
<p><img src="/assets/image-20201106112125535.png" alt="image-20201106112125535"></p>
<p><em>Fig. 1.3.2.2 External Threats Alerts Data Size dashboard.</em></p>
<p><img src="/assets/image-20201106112159510.png" alt="image-20201106112159510"></p>
<p><em>Fig. 1.3.2.3 External Threats Alerts Map dashboard.</em></p>
<h4><a class="anchor" aria-hidden="true" id="133-internal-threats"></a><a href="#133-internal-threats" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.3.3. Internal Threats</h4>
<p>Internal Threats dashboards focus on presenting artifacts related to security threats from within the organization. <em>Tab. 1.3.3.1</em> contains descriptions of Internal Threats submenu Alerts Drilldown dashboard.</p>
<table>
<thead>
<tr><th>Dashboard Name</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Alerts Drilldown</td><td>An interactive view containing a drilldown table with expandable attributes for criticality and IP addresses, and a graph of connections between individual IP addresses. Security threats can be searched and analysed based on many attributes, such as Severity, Source Host, Destination Host, Tactic, Technique, Alert Name, Application, Direction, Source Group, Destination Group or Destination Country.</td></tr>
</tbody>
</table>
<p><em>Tab. 1.3.3.1 Internal Threats - Alerts Drilldown dashboard description</em>.</p>
<p>In the <em>Fig. 1.3.3.1</em> you can see Alerts Drilldown dashboard.</p>
<p><img src="assets/image-20210210104220918.png" alt="image-20210210104220918" style="zoom:150%;" /></p>
<p><em>Fig. 1.3.3.1 Internal Threats - Alerts Drilldown dashboard.</em></p>
<h3><a class="anchor" aria-hidden="true" id="14-alerts"></a><a href="#14-alerts" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.4. Alerts</h3>
<p>The alert menu contains a list of detected alarms along with their occurrence times and other attributes. There are two dashboards: Overview and Mitre KB that are described in the <em>Tab. 1.4.1</em> and shown in <em>Fig. 1.4.1-1.4.2.</em></p>
<table>
<thead>
<tr><th>Dashboard Name</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Overview</td><td>A table of threats and security anomalies detected by the XNS module containing the attributes necessary for their analysis.</td></tr>
<tr><td>MITRE KB</td><td>A dashboard showing the integration of the MITRE ATT&amp;CK knowledge base with XNS alerts, which enriches them with additional information about a specific threat.</td></tr>
</tbody>
</table>
<p><em>Tab. 1.4.1 Alerts menu dashboards description</em>.</p>
<p><img src="/assets/image-20201106112402471.png" alt="image-20201106112402471"></p>
<p><em>Fig. 1.4.1 Alerts Overview dashboards.</em></p>
<p><img src="/assets/image-20201106112445004.png" alt="image-20201106112445004"></p>
<p><em>Fig. 1.4.2 Alerts MITRE KB dashboard.</em></p>
<p>If you need a full description of a given technique, use the redirect function to the appropriate page using the right mouse click on the <strong>Id</strong> attribute on the Alerts/MITRE KB dashboard (<em>Fig. 1.4.3</em>).</p>
<p><img src="/assets/image-20210210103933305.png" alt="image-20210210103933305"></p>
<p><em>Fig. 1.4.3 MITRE KB - Right click function</em>.</p>
<h2><a class="anchor" aria-hidden="true" id="2-threat-detection"></a><a href="#2-threat-detection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Threat Detection</h2>
<p>The Threat Detection engine generates alerts based on correlations of relevant attributes of network flows (e.g. Netflow) indicating potential security issues. This mechanism consists of 38 security rules for seven MITRE ATT&amp;CK tactics: Initial Access, Credential Access, Discovery, Lateral Movement, Command and Control, Exfiltration and Impact.</p>
<h3><a class="anchor" aria-hidden="true" id="21-threat-detection-rules"></a><a href="#21-threat-detection-rules" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.1. Threat Detection Rules</h3>
<p>This section describes all rules triggered by the Threat Detection engine.</p>
<table>
<thead>
<tr><th><strong>Name</strong></th></tr>
</thead>
<tbody>
<tr><td>Anormal  flows ratios</td></tr>
<tr><td>Brute  Force Attack</td></tr>
<tr><td>Cleartext  Application (Ext-&gt;Ext)</td></tr>
<tr><td>Cleartext  Application (Ext-&gt;Int)</td></tr>
<tr><td>Cleartext  Application (Int-&gt;Ext)</td></tr>
<tr><td>Cleartext  Application (Int-&gt;Int)</td></tr>
<tr><td>DDoS  Attack Detected</td></tr>
<tr><td>DDoS  DNS Amplification Attack</td></tr>
<tr><td>Horizontal  Scan</td></tr>
<tr><td>Unauthorized  Internet Access</td></tr>
<tr><td>Unauthorized  DHCP Activity</td></tr>
<tr><td>Unauthorized  DNS Activity</td></tr>
<tr><td>Vertical  Scan Detected</td></tr>
<tr><td>DoS  Attack Detected</td></tr>
<tr><td>DoS -  ICMP Flood</td></tr>
<tr><td>DoS -  TCP Flood</td></tr>
<tr><td>DoS -  UDP Flood</td></tr>
<tr><td>Abnormal  DNS Query Limit</td></tr>
<tr><td>Abnormal  DNS Response Limit</td></tr>
<tr><td>DNS  Transfer Limit</td></tr>
<tr><td>High  Data Transfer (Int-&gt;Ext)</td></tr>
<tr><td>High  Data Transfer (Ext-&gt;Int)</td></tr>
<tr><td>High  Data Transfer (Int-&gt;Int)</td></tr>
<tr><td>Unusually  High Data Transfer (Int-&gt;Ext)</td></tr>
<tr><td>Unusually  High Data Transfer (Ext-&gt;Int)</td></tr>
<tr><td>P2P  Activity</td></tr>
<tr><td>Large  Size Protocol Anomaly</td></tr>
<tr><td>Multicast  DNS (mDNS) from Internet</td></tr>
<tr><td>OT  Device Discovered</td></tr>
<tr><td>SPAM  (Ext-&gt;Int)</td></tr>
<tr><td>SPAM  (Ext-&gt;Ext)</td></tr>
<tr><td>SPAM  (Int-&gt;Ext)</td></tr>
<tr><td>SPAM  (Int-&gt;Int)</td></tr>
<tr><td>Suspicious  Port BL</td></tr>
<tr><td>Suspicious  Port WL</td></tr>
<tr><td>Unauthorized  NFS Export Outside The Local Network</td></tr>
<tr><td>Unauthorized  RDP from Internet</td></tr>
</tbody>
</table>
<p><em>Tab. 2.1.1 Threat Detection Rules</em>.</p>
<h3><a class="anchor" aria-hidden="true" id="22-initial-configuration"></a><a href="#22-initial-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.2. Initial Configuration</h3>
<p>All Threat Detection rules are disabled by default to reduce the number of False Positives. In the initial rule configuration process, set rule parameters, such as groups or limits on specific attributes. Each rule has its own set of characteristics, so each of them must be configured separately. For example, in the <em>Abnormal flow ratios</em> rule, set the Flow Count, PPF and Whitelists Group parameters.</p>
<p><img src="/assets/2020-11-06_11-57-46.png" alt="2020-11-06_11-57-46"></p>
<p><em>Fig. 2.2.1 Security Alert Configuration</em>.</p>
<p>If as a result of the analysis, it was determined that a given rule generates many false alarms, then the fine tuning process should be performed.</p>
<h2><a class="anchor" aria-hidden="true" id="3-threat-intelligence-engine"></a><a href="#3-threat-intelligence-engine" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Threat Intelligence Engine</h2>
<p>The Threat Intelligence engine generates alerts based on correlation network flow attributes with external and internal IoCs. XNS regularly updates more than 30 security feeds of malicious IP addresses and suspicious countries.
The Threat Intelligence mechanism consists of two parts:</p>
<p>•       <em>External Threat Intelligence</em>, which uses automatically updated feeds downloaded from the Internet</p>
<p>•       <em>Internal Threat Intelligence</em>, which uses manually created and updated feeds.</p>
<p>Both subsystems generate the following security alerts:</p>
<p>•       Connection with Suspicious IP</p>
<p>•       Connection with Suspicious Country</p>
<p>•       Connection with Open Proxy</p>
<p>•       Connection with Open DNS</p>
<p>•       Connection with TOR.</p>
<p>Each of these alerts can be triggered by many reputational feeds.</p>
<h3><a class="anchor" aria-hidden="true" id="31-threat-intelligence-feeds"></a><a href="#31-threat-intelligence-feeds" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.1. Threat Intelligence Feeds</h3>
<p>The Threat Intelligence of XNS consists of external and internal (custom) feeds.</p>
<table>
<thead>
<tr><th>Feed id</th><th>Name</th><th>Score</th><th>Description</th><th>MITRE Tactic</th><th>MITRE Techniqe</th></tr>
</thead>
<tbody>
<tr><td>IP_CRYPTO_MINING</td><td>Suspicious  IP</td><td>6</td><td>The  alert is triggered as a result of detection traffic with CRYPTO MINING IP  address.</td><td>Impact</td><td>Resource  Hijacking</td></tr>
<tr><td>IP_MALWARE</td><td>Malicious  IP</td><td>10</td><td>The  alert is triggered as a result of detection traffic with MALWARE IP address.</td><td>Command  and Control</td><td>Application  Layer Protocol</td></tr>
<tr><td>IP_OPEN_DNS</td><td>Suspicious  IP</td><td>3</td><td>The  alert is triggered as a result of detection traffic with OPEN DNS IP address.</td><td>Command  and Control</td><td>Application  Layer Protocol</td></tr>
<tr><td>IP_PHISHING</td><td>Suspicious  IP</td><td>9</td><td>The  alert is triggered as a result of detection traffic with PHISHING IP address.</td><td>Initial  Access</td><td>Phishing</td></tr>
<tr><td>IP_PROXY</td><td>Anonymous  Proxy</td><td>4</td><td>The  alert is triggered as a result of detection traffic with PROXY IP address.</td><td>Command  and Control</td><td>Proxy</td></tr>
<tr><td>IP_SCANNER</td><td>Suspicious  IP</td><td>4</td><td>The  alert is triggered as a result of detection traffic with SCANNER IP address.</td><td>Discovery</td><td>Network  Service Scanning</td></tr>
<tr><td>IP_SPAM</td><td>Suspicious  IP</td><td>5</td><td>The  alert is triggered as a result of detection traffic with SPAM IP address.</td><td>Initial  Access</td><td>Phishing</td></tr>
<tr><td>IP_SYCOPE_COMMUNITY</td><td>Malicious  IP</td><td>8</td><td>The  alert is triggered as a result of detection traffic with malicious IP address  noticed by Sycope Community members.</td><td>Command  and Control</td><td>Application  Layer Protocol</td></tr>
<tr><td>IP_TOR</td><td>TOR  Activity</td><td>7</td><td>The  alert is triggered as a result of detection traffic with TOR IP address.</td><td>Command  and Control</td><td>Proxy</td></tr>
</tbody>
</table>
<p><em>Tab. 3.1.1 Threat Intelligence - External Feeds</em>.</p>
<table>
<thead>
<tr><th>Feed id</th><th>Name</th><th>Score</th><th>Description</th><th>MITRE Tactic</th><th>MITRE Techniqe</th></tr>
</thead>
<tbody>
<tr><td>ThreatIntelligence_custom</td><td>Suspicious  IP</td><td>8</td><td>Internal  Threat Intelligence - Custom Feed.</td><td>Command  and Control</td><td>Application  Layer Protocol</td></tr>
<tr><td>WhitelistIP</td><td>Exception</td><td>1</td><td>IP  Whitelist</td><td>Command  and Control</td><td>Application  Layer Protocol</td></tr>
<tr><td>Country_custom</td><td>Suspicious  Country</td><td>6</td><td>The  Worst Botnet Countries based on custom list.</td><td>Command  and Control</td><td>Application  Layer Protocol</td></tr>
<tr><td>Sunburst2</td><td>Suspicious  IP - Sunburst (Sig2)</td><td>10</td><td>The  feed includes malicious IPs regarding the Sunburst backdoor. Attacker  leverages SolarWinds supply chain to compromise multiple global victims with  this backdoor.</td><td>Lateral  Movement</td><td>Remote  Services</td></tr>
</tbody>
</table>
<p><em>Tab. 3.1.2  Sample of Threat Intelligence - Internal Feeds</em>.</p>
<h3><a class="anchor" aria-hidden="true" id="32-initial-configuration"></a><a href="#32-initial-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.2. Initial Configuration</h3>
<p>Feed management is only possible from the system administrator level. To change any feed, go to the <em>Settings/Security/External Threat Intelligence</em> or <em>Settings/Security/Internal Threat Intelligence</em>, and then select the feed for which you want to change parameters.</p>
<p>Note: In order for external feeds to be constantly updated, it is necessary to allow communication to the addresses of individual feeds. For more information please contact Support.</p>
<p><img src="/assets/2020-11-06_11-30-36.png" alt="2020-11-06_11-30-36"></p>
<p><em>Fig. 3.2.1 XNS External Threat Intelligence</em>.</p>
<p>The External Threat Intelligence rules contain the following attributes: Enabled, Alert Name, Feed Id, Data Type, Threat Category, MITRE Tactic, MITRE Technique, Score, Refresh Interval, Last Refresh Time and Alert Description.</p>
<table>
<thead>
<tr><th>Attribute</th><th>Description</th><th>Possible Values</th><th>Modifiable</th></tr>
</thead>
<tbody>
<tr><td>Enabled</td><td>The attribute indicates the status of the rule. Disabled rules do not generate security alerts.</td><td>Enabled, Disabled</td><td><img src="/assets/clip_image057-1600346541178.png" alt=""></td></tr>
<tr><td>Alert Name</td><td>The attribute indicating the name of the  rule.</td><td>Connection with a Suspicious IP, Connection with a Suspicious Country, Connection with Open Proxy, Connection with TOR</td><td><img src="/assets/clip_image058-1600346541178.png" alt=""></td></tr>
<tr><td>Feed Id</td><td>The attribute indicating the Feed Id for each Threat Intelligence rule. Each rule has a unique value of the Feed Id attribute.</td><td></td><td><img src="/assets/clip_image058-1600346541178.png" alt=""></td></tr>
<tr><td>Data Type</td><td>The attribute indicating the type of collected data for each feed.</td><td>IP, Country</td><td><img src="/assets/clip_image058-1600346541178.png" alt=""></td></tr>
<tr><td>Threat Category</td><td>The attribute indicating the category of feed related to types of security threats.</td><td>Bot, Botnet, C2, Feodo, Malicious Malware,  Open Proxy, Ransomware, Rogue DNS, SNMP BL, SSH BL, Telnet BL, TOR, Zeus</td><td><img src="/assets/clip_image058-1600346541178.png" alt=""></td></tr>
<tr><td>MITRE Tactic</td><td>The attribute indicating the tactic of MITRE ATT&amp;CK related to a security rule.</td><td>Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access Discovery, Lateral  Movement Collection, Command and Control, Exfiltration, Impact</td><td><img src="/assets/clip_image058-1600346541178.png" alt=""></td></tr>
<tr><td>MITRE Technique</td><td>The attribute indicating the Technique of MITRE ATT&amp;CK related to a security rule. There are about about 200  techniques - more details <a href="https://attack.mitre.org/matrices/enterprise/">ATT&amp;CK MITRE</a>.</td><td></td><td><img src="/assets/clip_image058-1600346541178.png" alt=""></td></tr>
<tr><td>Score</td><td>Attribute indicating the importance of the feed on a scale of 1 to 10.</td><td>{1..10}</td><td><img src="/assets/clip_image057-1600346541178.png" alt=""></td></tr>
<tr><td>Refresh Interval</td><td>Attribute indicating the time interval, how often (in minutes) a feed should be updated.</td><td>{0..32767}</td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>Last Refresh Time</td><td>Attribute indicating the last feed update in format YYYYMMDDhhmm.</td><td></td><td><img src="/assets/clip_image058-1600346541178.png" alt="NOT_OK_S"></td></tr>
<tr><td>Alert Description</td><td>Attribute indicating the description of the feed.</td><td></td><td><img src="/assets/clip_image058-1600346541178.png" alt="NOT_OK_S"></td></tr>
</tbody>
</table>
<p><em>Tab. 3.2.1 External Threat Intelligence Feed Attributes</em>.</p>
<p><img src="/assets/image-20201106113501294.png" alt="image-20201106113501294"></p>
<p><em>Fig. 3.2.2 External Threat Intelligence Alert Configuration</em>.</p>
<p>The Internal Threat Intelligence engine correlates custom feeds with some attributes of network flows. For this type of alert, all attributes except the alert name can be modified.</p>
<table>
<thead>
<tr><th>Attribute</th><th>Description</th><th>Possible Values</th><th>Modifiable</th></tr>
</thead>
<tbody>
<tr><td>Enabled</td><td>The attribute indicates the status of the rule. Disabled rules do not generate security alerts.</td><td>Enabled, Disabled</td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>Alert Name</td><td>The attribute indicating the name of the rule. The attribute can be set only once when creating a new custom feed.</td><td></td><td><img src="/assets/clip_image058-1600346541178.png" alt="NOT_OK_S"></td></tr>
<tr><td>Feed Id</td><td>The attribute indicating the Feed Id for each rule. Each rule has a unique value of the Feed Id attribute.</td><td></td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>Data Type</td><td>The attribute indicating the type of collected data for each feed.</td><td>IP, Country</td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>Threat Category</td><td>The attribute indicating the category of feed related to types of security threats.</td><td>Bot, Botnet, C2, Feodo, Malicious Malware,  Open Proxy, Ransomware, Rogue DNS, SNMP BL, SSH BL, Telnet BL, TOR, Zeus</td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>MITRE Tactic</td><td>The attribute indicating a Tactic of MITRE  ATT&amp;CK related to a security rule.</td><td>Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access Discovery, Lateral  Movement Collection, Command and Control, Exfiltration, Impact</td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>MITRE Technique</td><td>The attribute indicating a Technique of MITRE ATT&amp;CK related to a security rule. There are about about 200  techniques - more details <a href="https://attack.mitre.org/matrices/enterprise/">ATT&amp;CK MITRE</a>.</td><td></td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>Score</td><td>Attribute indicating the importance of the feed on a scale of 1 to 10.</td><td>{1..10}</td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>Alert Description</td><td>Attribute indicating the description of the feed.</td><td></td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
<tr><td>Feed Data List</td><td>Attribute indicating the values of custom feeds (IP address or Country), one value per line.</td><td></td><td><img src="/assets/clip_image057-1600346541178.png" alt="OK_S"></td></tr>
</tbody>
</table>
<p><em>Tab. 3.2.2 Internal Threat Intelligence Feed Attributes</em>.</p>
<p><img src="/assets/image-20201106113620656.png" alt="image-20201106113620656"></p>
<p><em>Fig. 3.2.3 Internal Threat Intelligence Alert Configuration</em>.</p>
<h4><a class="anchor" aria-hidden="true" id="321-creating-a-custom-feed"></a><a href="#321-creating-a-custom-feed" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.2.1. Creating a custom feed</h4>
<p>Below are the steps to create custom feeds:</p>
<ol>
<li>In the <strong>Settings -&gt; Security -&gt; Internal Threat Intelligence</strong> click <strong>ADD NEW</strong> option.</li>
</ol>
<p><img src="/assets/2020-11-06_11-37-25.png" alt="2020-11-06_11-37-25"></p>
<p><em>Fig. 3.2.1.1  Creating a custom feed - step 1</em>.</p>
<ol start="2">
<li>Fill in the attributes of the new feed and click apply.</li>
</ol>
<p><img src="/assets/2020-11-06_11-48-26.png" alt="2020-11-06_11-48-26"></p>
<p>Fig. 3.2.1.2 <em>Creating a custom feed - step 2</em>.</p>
<p>Note: Please remember that only enabled rules generate alerts.</p>
<h4><a class="anchor" aria-hidden="true" id="323-adding-ip-addresses-to-the-whitelist"></a><a href="#323-adding-ip-addresses-to-the-whitelist" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.2.3. Adding IP addresses to the Whitelist</h4>
<p>Below are the steps of adding IP addresses to the Whitelist IP for Threat Intelligence rules :</p>
<ol>
<li>In the <strong>Settings -&gt; Security -&gt; Internal Threat Intelligence</strong> choose the WhitelistIP_whitelist feed.</li>
</ol>
<p><img src="/assets/image-20201106115217466.png" alt="image-20201106115217466"></p>
<p><em>Fig. 3.2.3.1 Adding IPs to the Whitelist - step 1</em>.</p>
<ol start="2">
<li>Edit the feed and add list of IPs which should be ignored by Threat Intelligence engine into the Feed Data List area.</li>
</ol>
<p><img src="/assets/image-20201106115547370.png" alt="image-20201106115547370"></p>
<p><em>Fig. 3.2.3.2 Adding IPs to the Whitelist - step 2</em>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/XN"><span class="arrow-prev">← </span><span>XN User Guide</span></a><a class="docs-next button" href="/XND"><span>XND User Guide</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#1-security-dashboards">1. Security Dashboards</a><ul class="toc-headings"><li><a href="#11-soc">1.1. SOC</a></li><li><a href="#12-kpis">1.2. KPIs</a></li><li><a href="#13-use-cases">1.3. Use Cases</a></li><li><a href="#14-alerts">1.4. Alerts</a></li></ul></li><li><a href="#2-threat-detection">2. Threat Detection</a><ul class="toc-headings"><li><a href="#21-threat-detection-rules">2.1. Threat Detection Rules</a></li><li><a href="#22-initial-configuration">2.2. Initial Configuration</a></li></ul></li><li><a href="#3-threat-intelligence-engine">3. Threat Intelligence Engine</a><ul class="toc-headings"><li><a href="#31-threat-intelligence-feeds">3.1. Threat Intelligence Feeds</a></li><li><a href="#32-initial-configuration">3.2. Initial Configuration</a></li></ul></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '7b969c492579575af2e774554cd0210e',
                indexName: 'flowcontrol12',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>